#!/usr/bin/env fish
set --query DOTFILES || dfs-init
set DOTFILES_HOME "$DOTFILES/home"

# link
fd . "$DOTFILES/home" --hidden --absolute-path --type file --exec dfs-link

# cleanup
fd . $HOME --hidden --type symlink --follow --max-depth 1 --exec-batch rm
fd . $HOME/{.config,.local,.ssh} --hidden --type symlink --follow --exec-batch rm
fd . $HOME/{.config,.local,.ssh} --hidden --type directory --type empty --exec-batch rmdir
