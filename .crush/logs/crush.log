{"time":"2025-08-07T22:30:51.844565-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T22:30:51.846388-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.Load","file":"/home/runner/work/crush/crush/internal/config/load.go","line":82},"msg":"No providers configured"}
{"time":"2025-08-07T22:30:51.84641-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T22:30:51.932143-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T22:30:52.37195-04:00","level":"INFO","msg":"OK   20250424200609_initial.sql (1.31ms)"}
{"time":"2025-08-07T22:30:52.372432-04:00","level":"INFO","msg":"OK   20250515105448_add_summary_message_id.sql (332.33µs)"}
{"time":"2025-08-07T22:30:52.372674-04:00","level":"INFO","msg":"OK   20250624000000_add_created_at_indexes.sql (230.29µs)"}
{"time":"2025-08-07T22:30:52.372936-04:00","level":"INFO","msg":"OK   20250627000000_add_provider_to_messages.sql (250.38µs)"}
{"time":"2025-08-07T22:30:52.372942-04:00","level":"INFO","msg":"goose: successfully migrated database to version: 20250627000000"}
{"time":"2025-08-07T22:30:52.372976-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T22:30:52.37299-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/app.New","file":"/home/runner/work/crush/crush/internal/app/app.go","line":97},"msg":"No agent configuration found"}
{"time":"2025-08-07T22:31:06.256026-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T22:31:06.257058-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T22:31:06.257068-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T22:31:06.257081-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T22:31:06.329846-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T22:31:06.779928-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T22:31:06.780008-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T22:31:06.782099-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T22:31:06.782223-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T22:31:06.783661-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T22:31:06.783684-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T22:31:24.949938-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T22:31:24.950915-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T22:31:24.950925-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T22:31:24.95093-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T22:31:25.1171-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T22:31:25.474277-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T22:31:25.47434-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T22:31:25.476187-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T22:31:25.476252-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T22:31:25.477897-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T22:31:25.477932-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T22:31:27.65653-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T22:31:27.656617-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T22:31:27.659246-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T22:31:27.659303-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T22:32:30.701318-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"unexpected EOF","attempt":1,"max_retries":8}
{"time":"2025-08-07T22:32:30.702299-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T22:34:28.727098-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Cancel","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":241},"msg":"Request cancellation initiated","session_id":"871bca89-8614-4bc2-b58a-e189b8f0f74b-summarize"}
{"time":"2025-08-07T22:34:33.552519-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T22:34:33.553902-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T22:34:33.553913-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T22:34:33.553909-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T22:34:33.633003-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T22:34:34.092358-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T22:34:34.09243-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T22:34:34.094418-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T22:34:34.094481-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T22:34:34.095975-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T22:34:34.096021-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T22:38:11.482413-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T22:38:11.484462-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T22:38:11.484472-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T22:38:11.484479-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T22:38:11.636402-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T22:38:12.022419-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T22:38:12.022488-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T22:38:12.025557-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T22:38:12.025847-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T22:38:12.027045-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T22:38:12.02709-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T22:44:38.657549-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).processEvent","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":627},"msg":"Tool call started","toolCall":{"id":"call_7ymvjgpi","name":"view","input":"","type":"","finished":false}}
{"time":"2025-08-07T23:05:13.054952-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:05:13.057298-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T23:05:13.057312-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T23:05:13.057446-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T23:05:13.592896-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T23:05:13.593512-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T23:05:13.59632-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T23:05:13.596451-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T23:05:13.597979-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T23:05:13.598014-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T23:05:13.727638-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:05:20.379593-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:05:20.38004-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:05:20.427376-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:05:20.427485-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:05:24.068288-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:05:24.068382-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:05:24.118256-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:05:24.118357-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:05:30.167479-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:05:30.167809-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:05:30.237041-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:05:30.237147-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:05:41.105052-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:05:41.106815-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:05:41.310316-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:05:41.310414-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:06:01.674971-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:06:01.676559-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:06:01.69593-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:06:01.69609-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:06:41.350261-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":6,"max_retries":8}
{"time":"2025-08-07T23:06:41.351717-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":6,"max_retries":8}
{"time":"2025-08-07T23:06:41.483161-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":6,"max_retries":8}
{"time":"2025-08-07T23:06:41.483437-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":6,"max_retries":8}
{"time":"2025-08-07T23:07:20.032783-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Cancel","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":241},"msg":"Request cancellation initiated","session_id":"fde2b0f0-a248-4354-8686-569d709cae76"}
{"time":"2025-08-07T23:10:20.400937-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:10:20.402268-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T23:10:20.402277-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T23:10:20.402301-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T23:10:20.522123-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:10:20.927468-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T23:10:20.92752-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T23:10:20.929467-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T23:10:20.929578-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T23:10:20.931071-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T23:10:20.931101-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T23:10:49.083231-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:10:49.084196-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T23:10:49.084207-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T23:10:49.084213-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T23:10:49.188309-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:10:49.608854-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T23:10:49.608916-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T23:10:49.610889-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T23:10:49.61097-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T23:10:49.612966-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T23:10:49.613008-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T23:11:02.425516-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:11:02.425722-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:11:02.503342-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:11:02.503435-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:11:05.982408-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:11:05.982552-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:11:06.211525-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:11:06.211678-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:11:12.175825-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:11:12.175897-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:11:12.194896-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:11:12.194949-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:11:23.020592-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:11:23.020676-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:11:23.044832-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:11:23.044925-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:11:43.468209-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:11:43.468354-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:11:43.603608-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:11:43.603725-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:12:18.122231-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Cancel","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":241},"msg":"Request cancellation initiated","session_id":"c60571ad-40b6-4481-bcab-5dba7c53163b"}
{"time":"2025-08-07T23:14:49.155559-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:14:49.158073-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T23:14:49.158087-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T23:14:49.158296-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T23:14:49.70647-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T23:14:49.707485-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T23:14:49.71049-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T23:14:49.710601-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T23:14:49.712072-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T23:14:49.712101-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T23:14:49.730852-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:14:56.926957-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:14:56.927-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:14:57.045834-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:14:57.045878-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:15:00.539391-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:15:00.539497-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:15:00.755255-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:15:00.755332-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:15:06.629921-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:15:06.630015-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:15:06.91074-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:15:06.910827-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:15:17.467254-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:15:17.467427-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:15:17.926444-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:15:17.92652-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:15:37.829094-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:15:37.829241-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:15:38.594663-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:11434/v1/chat/completions\": dial tcp [::1]:11434: connect: connection refused","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:15:38.594779-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:15:56.721265-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Cancel","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":241},"msg":"Request cancellation initiated","session_id":"987452b3-ed86-411d-865d-4140aa655b52"}
{"time":"2025-08-07T23:15:57.308118-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:15:57.309448-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T23:15:57.309454-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T23:15:57.309464-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T23:15:57.569365-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:15:57.849707-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T23:15:57.849762-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T23:15:57.851538-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T23:15:57.851595-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T23:15:57.853133-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T23:15:57.853176-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T23:16:04.628029-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"Field with key llm.prediction.maxPredictedTokens does not satisfy the schema:[\\n  {\\n    \\\"code\\\": \\\"too_small\\\",\\n    \\\"minimum\\\": 1,\\n    \\\"type\\\": \\\"number\\\",\\n    \\\"inclusive\\\": true,\\n    \\\"exact\\\": false,\\n    \\\"message\\\": \\\"Number must be greater than or equal to 1\\\",\\n    \\\"path\\\": [\\n      \\\"value\\\"\\n    ]\\n  }\\n]\"}","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:16:04.628081-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:16:04.629654-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"Field with key llm.prediction.maxPredictedTokens does not satisfy the schema:[\\n  {\\n    \\\"code\\\": \\\"too_small\\\",\\n    \\\"minimum\\\": 1,\\n    \\\"type\\\": \\\"number\\\",\\n    \\\"inclusive\\\": true,\\n    \\\"exact\\\": false,\\n    \\\"message\\\": \\\"Number must be greater than or equal to 1\\\",\\n    \\\"path\\\": [\\n      \\\"value\\\"\\n    ]\\n  }\\n]\"}","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:16:04.629675-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:16:07.040523-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"Field with key llm.prediction.maxPredictedTokens does not satisfy the schema:[\\n  {\\n    \\\"code\\\": \\\"too_small\\\",\\n    \\\"minimum\\\": 1,\\n    \\\"type\\\": \\\"number\\\",\\n    \\\"inclusive\\\": true,\\n    \\\"exact\\\": false,\\n    \\\"message\\\": \\\"Number must be greater than or equal to 1\\\",\\n    \\\"path\\\": [\\n      \\\"value\\\"\\n    ]\\n  }\\n]\"}","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:16:07.040602-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:16:07.042638-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"Field with key llm.prediction.maxPredictedTokens does not satisfy the schema:[\\n  {\\n    \\\"code\\\": \\\"too_small\\\",\\n    \\\"minimum\\\": 1,\\n    \\\"type\\\": \\\"number\\\",\\n    \\\"inclusive\\\": true,\\n    \\\"exact\\\": false,\\n    \\\"message\\\": \\\"Number must be greater than or equal to 1\\\",\\n    \\\"path\\\": [\\n      \\\"value\\\"\\n    ]\\n  }\\n]\"}","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:16:07.042708-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:16:11.856769-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"Field with key llm.prediction.maxPredictedTokens does not satisfy the schema:[\\n  {\\n    \\\"code\\\": \\\"too_small\\\",\\n    \\\"minimum\\\": 1,\\n    \\\"type\\\": \\\"number\\\",\\n    \\\"inclusive\\\": true,\\n    \\\"exact\\\": false,\\n    \\\"message\\\": \\\"Number must be greater than or equal to 1\\\",\\n    \\\"path\\\": [\\n      \\\"value\\\"\\n    ]\\n  }\\n]\"}","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:16:11.85697-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:16:11.858092-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"Field with key llm.prediction.maxPredictedTokens does not satisfy the schema:[\\n  {\\n    \\\"code\\\": \\\"too_small\\\",\\n    \\\"minimum\\\": 1,\\n    \\\"type\\\": \\\"number\\\",\\n    \\\"inclusive\\\": true,\\n    \\\"exact\\\": false,\\n    \\\"message\\\": \\\"Number must be greater than or equal to 1\\\",\\n    \\\"path\\\": [\\n      \\\"value\\\"\\n    ]\\n  }\\n]\"}","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:16:11.858124-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:16:21.472679-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"Field with key llm.prediction.maxPredictedTokens does not satisfy the schema:[\\n  {\\n    \\\"code\\\": \\\"too_small\\\",\\n    \\\"minimum\\\": 1,\\n    \\\"type\\\": \\\"number\\\",\\n    \\\"inclusive\\\": true,\\n    \\\"exact\\\": false,\\n    \\\"message\\\": \\\"Number must be greater than or equal to 1\\\",\\n    \\\"path\\\": [\\n      \\\"value\\\"\\n    ]\\n  }\\n]\"}","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:16:21.472763-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:16:21.473458-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"Field with key llm.prediction.maxPredictedTokens does not satisfy the schema:[\\n  {\\n    \\\"code\\\": \\\"too_small\\\",\\n    \\\"minimum\\\": 1,\\n    \\\"type\\\": \\\"number\\\",\\n    \\\"inclusive\\\": true,\\n    \\\"exact\\\": false,\\n    \\\"message\\\": \\\"Number must be greater than or equal to 1\\\",\\n    \\\"path\\\": [\\n      \\\"value\\\"\\n    ]\\n  }\\n]\"}","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:16:21.473495-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:16:40.694384-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"Field with key llm.prediction.maxPredictedTokens does not satisfy the schema:[\\n  {\\n    \\\"code\\\": \\\"too_small\\\",\\n    \\\"minimum\\\": 1,\\n    \\\"type\\\": \\\"number\\\",\\n    \\\"inclusive\\\": true,\\n    \\\"exact\\\": false,\\n    \\\"message\\\": \\\"Number must be greater than or equal to 1\\\",\\n    \\\"path\\\": [\\n      \\\"value\\\"\\n    ]\\n  }\\n]\"}","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:16:40.694431-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:16:40.695901-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"Field with key llm.prediction.maxPredictedTokens does not satisfy the schema:[\\n  {\\n    \\\"code\\\": \\\"too_small\\\",\\n    \\\"minimum\\\": 1,\\n    \\\"type\\\": \\\"number\\\",\\n    \\\"inclusive\\\": true,\\n    \\\"exact\\\": false,\\n    \\\"message\\\": \\\"Number must be greater than or equal to 1\\\",\\n    \\\"path\\\": [\\n      \\\"value\\\"\\n    ]\\n  }\\n]\"}","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:16:40.69592-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:17:19.104283-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"Field with key llm.prediction.maxPredictedTokens does not satisfy the schema:[\\n  {\\n    \\\"code\\\": \\\"too_small\\\",\\n    \\\"minimum\\\": 1,\\n    \\\"type\\\": \\\"number\\\",\\n    \\\"inclusive\\\": true,\\n    \\\"exact\\\": false,\\n    \\\"message\\\": \\\"Number must be greater than or equal to 1\\\",\\n    \\\"path\\\": [\\n      \\\"value\\\"\\n    ]\\n  }\\n]\"}","attempt":6,"max_retries":8}
{"time":"2025-08-07T23:17:19.104393-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":6,"max_retries":8}
{"time":"2025-08-07T23:17:19.107896-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"Field with key llm.prediction.maxPredictedTokens does not satisfy the schema:[\\n  {\\n    \\\"code\\\": \\\"too_small\\\",\\n    \\\"minimum\\\": 1,\\n    \\\"type\\\": \\\"number\\\",\\n    \\\"inclusive\\\": true,\\n    \\\"exact\\\": false,\\n    \\\"message\\\": \\\"Number must be greater than or equal to 1\\\",\\n    \\\"path\\\": [\\n      \\\"value\\\"\\n    ]\\n  }\\n]\"}","attempt":6,"max_retries":8}
{"time":"2025-08-07T23:17:19.107983-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":6,"max_retries":8}
{"time":"2025-08-07T23:18:35.916676-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"Field with key llm.prediction.maxPredictedTokens does not satisfy the schema:[\\n  {\\n    \\\"code\\\": \\\"too_small\\\",\\n    \\\"minimum\\\": 1,\\n    \\\"type\\\": \\\"number\\\",\\n    \\\"inclusive\\\": true,\\n    \\\"exact\\\": false,\\n    \\\"message\\\": \\\"Number must be greater than or equal to 1\\\",\\n    \\\"path\\\": [\\n      \\\"value\\\"\\n    ]\\n  }\\n]\"}","attempt":7,"max_retries":8}
{"time":"2025-08-07T23:18:35.91704-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":7,"max_retries":8}
{"time":"2025-08-07T23:18:35.920379-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"Field with key llm.prediction.maxPredictedTokens does not satisfy the schema:[\\n  {\\n    \\\"code\\\": \\\"too_small\\\",\\n    \\\"minimum\\\": 1,\\n    \\\"type\\\": \\\"number\\\",\\n    \\\"inclusive\\\": true,\\n    \\\"exact\\\": false,\\n    \\\"message\\\": \\\"Number must be greater than or equal to 1\\\",\\n    \\\"path\\\": [\\n      \\\"value\\\"\\n    ]\\n  }\\n]\"}","attempt":7,"max_retries":8}
{"time":"2025-08-07T23:18:35.920423-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":7,"max_retries":8}
{"time":"2025-08-07T23:18:39.508905-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Cancel","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":241},"msg":"Request cancellation initiated","session_id":"0bce77b1-ad5a-432d-bd93-8561d51bc699"}
{"time":"2025-08-07T23:20:20.838824-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:20:20.840224-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T23:20:20.84023-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:20:20.840257-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:20:20.992096-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:20:21.363237-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T23:20:21.363296-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T23:20:21.36517-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T23:20:21.365218-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T23:20:21.367143-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T23:20:21.367185-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T23:20:25.412771-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:20:25.412808-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:20:27.851332-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:20:27.851366-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:20:32.689158-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:20:32.689188-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:20:37.197082-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Cancel","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":241},"msg":"Request cancellation initiated","session_id":"64c79d35-8d72-4629-8312-cd8fb3d0501d"}
{"time":"2025-08-07T23:20:39.302778-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:20:39.303895-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T23:20:39.303905-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:20:39.30393-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:20:39.381269-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:20:39.832322-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA foreign_keys = ON;"}
{"time":"2025-08-07T23:20:39.834512-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA journal_mode = WAL;"}
{"time":"2025-08-07T23:20:39.834531-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA page_size = 4096;"}
{"time":"2025-08-07T23:20:39.834542-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA cache_size = -8000;"}
{"time":"2025-08-07T23:20:39.834551-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA synchronous = NORMAL;"}
{"time":"2025-08-07T23:20:39.83472-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T23:20:39.834758-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T23:20:39.837212-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T23:20:39.837255-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T23:20:39.838691-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T23:20:39.838711-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T23:20:42.249028-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Run.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":337},"msg":"Request started","sessionID":"cc13085d-0655-40fa-898f-6777506d49d4"}
{"time":"2025-08-07T23:20:42.252348-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nhi\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:20:42.253744-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n      - git/\\n        - config\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - crush/\\n        - crush.json\\n      - opencode/\\n        - opencode.json\\n      - tofi/\\n        - config\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n        - style.css\\n      - vim/\\n        - vimrc\\n  - README.md\\n  - boot.sh\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n  - main.fish\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - darwin/\\n      - brew.fish\\n      - macos.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n    - link.fish\\n  - doc/\\n    - flow.txt\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:20:42.528391-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:20:42 GMT"],"X-Powered-By":["Express"]},"body":"data: {\"id\":\"chatcmpl-q2scsqmg6y7jsfqyqmdcv\",\"object\":\"chat.completion.chunk\",\"created\":1754623242,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{\"role\":\"assistant\",\"content\":\"Simple\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-q2scsqmg6y7jsfqyqmdcv\",\"object\":\"chat.completion.chunk\",\"created\":1754623242,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" greeting\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-q2scsqmg6y7jsfqyqmdcv\",\"object\":\"chat.completion.chunk\",\"created\":1754623242,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"\\n\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-q2scsqmg6y7jsfqyqmdcv\",\"object\":\"chat.completion.chunk\",\"created\":1754623242,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-q2scsqmg6y7jsfqyqmdcv\",\"object\":\"chat.completion.chunk\",\"created\":1754623242,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{},\"logprobs\":null,\"finish_reason\":\"stop\"}]}\n\ndata: {\"id\":\"chatcmpl-q2scsqmg6y7jsfqyqmdcv\",\"object\":\"chat.completion.chunk\",\"created\":1754623242,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[],\"usage\":{\"prompt_tokens\":111,\"completion_tokens\":4,\"total_tokens\":115}}\n\ndata: [DONE]\n\n","content_length":-1,"duration_ms":8,"error":null}
{"time":"2025-08-07T23:20:42.554929-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:20:42 GMT"],"X-Powered-By":["Express"]},"body":"event: error\ndata: {\"error\":{\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"},\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}\n\n","content_length":-1,"duration_ms":11,"error":null}
{"time":"2025-08-07T23:20:42.555146-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:20:42.555208-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:20:44.959201-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n      - git/\\n        - config\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - crush/\\n        - crush.json\\n      - opencode/\\n        - opencode.json\\n      - tofi/\\n        - config\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n        - style.css\\n      - vim/\\n        - vimrc\\n  - README.md\\n  - boot.sh\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n  - main.fish\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - darwin/\\n      - brew.fish\\n      - macos.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n    - link.fish\\n  - doc/\\n    - flow.txt\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:20:44.993741-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:20:44 GMT"],"X-Powered-By":["Express"]},"body":"event: error\ndata: {\"error\":{\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"},\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}\n\n","content_length":-1,"duration_ms":5,"error":null}
{"time":"2025-08-07T23:20:44.993795-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:20:44.993805-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:20:49.795432-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n      - git/\\n        - config\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - crush/\\n        - crush.json\\n      - opencode/\\n        - opencode.json\\n      - tofi/\\n        - config\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n        - style.css\\n      - vim/\\n        - vimrc\\n  - README.md\\n  - boot.sh\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n  - main.fish\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - darwin/\\n      - brew.fish\\n      - macos.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n    - link.fish\\n  - doc/\\n    - flow.txt\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:20:49.828818-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:20:49 GMT"],"X-Powered-By":["Express"]},"body":"event: error\ndata: {\"error\":{\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"},\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}\n\n","content_length":-1,"duration_ms":3,"error":null}
{"time":"2025-08-07T23:20:49.829088-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:20:49.82913-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:20:59.431017-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n      - git/\\n        - config\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - crush/\\n        - crush.json\\n      - opencode/\\n        - opencode.json\\n      - tofi/\\n        - config\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n        - style.css\\n      - vim/\\n        - vimrc\\n  - README.md\\n  - boot.sh\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n  - main.fish\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - darwin/\\n      - brew.fish\\n      - macos.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n    - link.fish\\n  - doc/\\n    - flow.txt\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:20:59.465358-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:20:59 GMT"],"X-Powered-By":["Express"]},"body":"event: error\ndata: {\"error\":{\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"},\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}\n\n","content_length":-1,"duration_ms":5,"error":null}
{"time":"2025-08-07T23:20:59.46542-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:20:59.465431-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:21:10.164988-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Cancel","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":241},"msg":"Request cancellation initiated","session_id":"cc13085d-0655-40fa-898f-6777506d49d4"}
{"time":"2025-08-07T23:21:10.165054-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"permissions"}
{"time":"2025-08-07T23:21:10.165075-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"lsp"}
{"time":"2025-08-07T23:21:10.165095-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"history"}
{"time":"2025-08-07T23:21:10.165111-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"sessions"}
{"time":"2025-08-07T23:21:10.165068-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).processGeneration","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":420},"msg":"Result","message":"","toolResults":null}
{"time":"2025-08-07T23:21:10.165128-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"coderAgent"}
{"time":"2025-08-07T23:21:10.16512-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"messages"}
{"time":"2025-08-07T23:21:10.165117-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"permissions-notifications"}
{"time":"2025-08-07T23:21:10.16514-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"mcp"}
{"time":"2025-08-07T23:21:10.165254-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).Subscribe.func2","file":"/home/runner/work/crush/crush/internal/app/app.go","line":291},"msg":"Cancelling TUI message handler"}
{"time":"2025-08-07T23:21:10.165305-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).Subscribe","file":"/home/runner/work/crush/crush/internal/app/app.go","line":300},"msg":"TUI message handler shutting down"}
{"time":"2025-08-07T23:21:27.777127-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:21:27.778125-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:21:27.778137-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:21:27.778142-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T23:21:27.928933-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:21:28.297936-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA foreign_keys = ON;"}
{"time":"2025-08-07T23:21:28.299907-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA journal_mode = WAL;"}
{"time":"2025-08-07T23:21:28.299926-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA page_size = 4096;"}
{"time":"2025-08-07T23:21:28.299937-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA cache_size = -8000;"}
{"time":"2025-08-07T23:21:28.299945-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA synchronous = NORMAL;"}
{"time":"2025-08-07T23:21:28.300121-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T23:21:28.300172-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T23:21:28.301989-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T23:21:28.302069-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T23:21:28.303576-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T23:21:28.30361-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T23:21:30.943538-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Run.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":337},"msg":"Request started","sessionID":"9804388b-2894-4bc2-965c-ccf8dde9bbd5"}
{"time":"2025-08-07T23:21:30.944715-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nadsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:21:30.945499-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n  - README.md\\n  - boot.sh\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - crush/\\n        - crush.json\\n      - git/\\n        - config\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - opencode/\\n        - opencode.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - vim/\\n        - vimrc\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n  - main.fish\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"adsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:21:30.945931-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:30.946263-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":0,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:31.401169-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n  - README.md\\n  - boot.sh\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - crush/\\n        - crush.json\\n      - git/\\n        - config\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - opencode/\\n        - opencode.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - vim/\\n        - vimrc\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n  - main.fish\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"adsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:21:31.403042-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:31.421907-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nadsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:21:31.423037-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:32.272829-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nadsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:21:32.274187-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:32.274291-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:1234/v1/chat/completions\": dial tcp [::1]:1234: connect: connection refused","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:21:32.274314-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:21:32.303073-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n  - README.md\\n  - boot.sh\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - crush/\\n        - crush.json\\n      - git/\\n        - config\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - opencode/\\n        - opencode.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - vim/\\n        - vimrc\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n  - main.fish\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"adsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:21:32.305314-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:32.305452-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:1234/v1/chat/completions\": dial tcp [::1]:1234: connect: connection refused","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:21:32.305475-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:21:34.674885-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nadsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:21:34.675859-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":0,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:34.708949-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n  - README.md\\n  - boot.sh\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - crush/\\n        - crush.json\\n      - git/\\n        - config\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - opencode/\\n        - opencode.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - vim/\\n        - vimrc\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n  - main.fish\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"adsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:21:34.710163-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":0,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:35.140624-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nadsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:21:35.141975-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:35.195809-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n  - README.md\\n  - boot.sh\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - crush/\\n        - crush.json\\n      - git/\\n        - config\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - opencode/\\n        - opencode.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - vim/\\n        - vimrc\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n  - main.fish\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"adsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:21:35.197494-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:35.921843-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nadsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:21:35.923782-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:35.923901-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:1234/v1/chat/completions\": dial tcp [::1]:1234: connect: connection refused","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:21:35.923925-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:21:36.123975-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n  - README.md\\n  - boot.sh\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - crush/\\n        - crush.json\\n      - git/\\n        - config\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - opencode/\\n        - opencode.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - vim/\\n        - vimrc\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n  - main.fish\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"adsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:21:36.125927-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:36.126022-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:1234/v1/chat/completions\": dial tcp [::1]:1234: connect: connection refused","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:21:36.126046-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:21:40.724727-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nadsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:21:40.726473-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:40.930826-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n  - README.md\\n  - boot.sh\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - crush/\\n        - crush.json\\n      - git/\\n        - config\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - opencode/\\n        - opencode.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - vim/\\n        - vimrc\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n  - main.fish\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"adsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:21:40.93205-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":0,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:41.139447-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nadsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:21:41.146788-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":7,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:41.37931-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n  - README.md\\n  - boot.sh\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - crush/\\n        - crush.json\\n      - git/\\n        - config\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - opencode/\\n        - opencode.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - vim/\\n        - vimrc\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n  - main.fish\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"adsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:21:41.381171-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:41.95421-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nadsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:21:41.955379-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:41.955485-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:1234/v1/chat/completions\": dial tcp [::1]:1234: connect: connection refused","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:21:41.955509-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:21:42.238992-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n  - README.md\\n  - boot.sh\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - crush/\\n        - crush.json\\n      - git/\\n        - config\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - opencode/\\n        - opencode.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - vim/\\n        - vimrc\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n  - main.fish\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"adsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:21:42.240748-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:42.241019-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:1234/v1/chat/completions\": dial tcp [::1]:1234: connect: connection refused","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:21:42.241046-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:21:51.556083-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nadsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:21:51.557744-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:51.84708-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n  - README.md\\n  - boot.sh\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - crush/\\n        - crush.json\\n      - git/\\n        - config\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - opencode/\\n        - opencode.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - vim/\\n        - vimrc\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n  - main.fish\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"adsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:21:51.84963-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:51.968973-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nadsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:21:51.970254-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:52.306698-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n  - README.md\\n  - boot.sh\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - crush/\\n        - crush.json\\n      - git/\\n        - config\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - opencode/\\n        - opencode.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - vim/\\n        - vimrc\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n  - main.fish\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"adsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:21:52.308902-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:52.741095-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nadsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:21:52.742242-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:52.74236-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:1234/v1/chat/completions\": dial tcp [::1]:1234: connect: connection refused","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:21:52.742382-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:21:53.228689-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n  - README.md\\n  - boot.sh\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - crush/\\n        - crush.json\\n      - git/\\n        - config\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - opencode/\\n        - opencode.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - vim/\\n        - vimrc\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n  - main.fish\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"adsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:21:53.22964-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":0,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:21:53.229678-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:1234/v1/chat/completions\": dial tcp [::1]:1234: connect: connection refused","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:21:53.229685-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:22:11.943352-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nadsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:22:11.945171-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:22:12.415157-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nadsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:22:12.416959-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:22:12.431219-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n  - README.md\\n  - boot.sh\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - crush/\\n        - crush.json\\n      - git/\\n        - config\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - opencode/\\n        - opencode.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - vim/\\n        - vimrc\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n  - main.fish\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"adsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:22:12.432117-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":0,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:22:12.933033-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n  - README.md\\n  - boot.sh\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - crush/\\n        - crush.json\\n      - git/\\n        - config\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - opencode/\\n        - opencode.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - vim/\\n        - vimrc\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n  - main.fish\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"adsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:22:12.93393-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":0,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:22:13.398141-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nadsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:22:13.399026-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":0,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:22:13.399063-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:1234/v1/chat/completions\": dial tcp [::1]:1234: connect: connection refused","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:22:13.399073-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:22:13.724069-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n  - README.md\\n  - boot.sh\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - crush/\\n        - crush.json\\n      - git/\\n        - config\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - opencode/\\n        - opencode.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - vim/\\n        - vimrc\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n  - main.fish\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"adsf\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:22:13.726273-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":57},"msg":"HTTP request failed","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"duration_ms":1,"error":"dial tcp [::1]:1234: connect: connection refused"}
{"time":"2025-08-07T23:22:13.726392-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:1234/v1/chat/completions\": dial tcp [::1]:1234: connect: connection refused","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:22:13.726415-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":5,"max_retries":8}
{"time":"2025-08-07T23:22:24.575301-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Cancel","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":241},"msg":"Request cancellation initiated","session_id":"9804388b-2894-4bc2-965c-ccf8dde9bbd5"}
{"time":"2025-08-07T23:22:24.575367-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"permissions"}
{"time":"2025-08-07T23:22:24.575396-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"permissions-notifications"}
{"time":"2025-08-07T23:22:24.57539-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"messages"}
{"time":"2025-08-07T23:22:24.575413-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"sessions"}
{"time":"2025-08-07T23:22:24.575424-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"lsp"}
{"time":"2025-08-07T23:22:24.575424-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"coderAgent"}
{"time":"2025-08-07T23:22:24.575402-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"mcp"}
{"time":"2025-08-07T23:22:24.575425-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"history"}
{"time":"2025-08-07T23:22:24.575397-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).processGeneration","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":420},"msg":"Result","message":"","toolResults":null}
{"time":"2025-08-07T23:22:24.575481-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).Subscribe.func2","file":"/home/runner/work/crush/crush/internal/app/app.go","line":291},"msg":"Cancelling TUI message handler"}
{"time":"2025-08-07T23:22:24.575508-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).Subscribe","file":"/home/runner/work/crush/crush/internal/app/app.go","line":300},"msg":"TUI message handler shutting down"}
{"time":"2025-08-07T23:23:43.832194-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:23:43.833466-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:23:43.833476-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:23:43.833479-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T23:23:43.914951-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:23:44.360715-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA foreign_keys = ON;"}
{"time":"2025-08-07T23:23:44.363771-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA journal_mode = WAL;"}
{"time":"2025-08-07T23:23:44.363803-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA page_size = 4096;"}
{"time":"2025-08-07T23:23:44.363816-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA cache_size = -8000;"}
{"time":"2025-08-07T23:23:44.363829-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA synchronous = NORMAL;"}
{"time":"2025-08-07T23:23:44.364-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T23:23:44.364039-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T23:23:44.365877-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T23:23:44.366402-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T23:23:44.367505-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T23:23:44.36753-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T23:23:46.88689-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Run.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":337},"msg":"Request started","sessionID":"4a9fa2a1-e23a-41d9-bfaf-50b3d92b57ff"}
{"time":"2025-08-07T23:23:46.88922-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nhi\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:23:46.890792-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - README.md\\n  - boot.sh\\n  - main.fish\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - opencode/\\n        - opencode.json\\n      - git/\\n        - config\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n      - crush/\\n        - crush.json\\n      - vim/\\n        - vimrc\\n      - tofi/\\n        - config\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n        - style.css\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - defaults.fish\\n      - macos.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n  - doc/\\n    - flow.txt\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:23:47.178323-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:23:46 GMT"],"X-Powered-By":["Express"]},"body":"data: {\"id\":\"chatcmpl-0zp7mnyauvtd32matgueod4\",\"object\":\"chat.completion.chunk\",\"created\":1754623426,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{\"role\":\"assistant\",\"content\":\"Simple\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-0zp7mnyauvtd32matgueod4\",\"object\":\"chat.completion.chunk\",\"created\":1754623426,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" greeting\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-0zp7mnyauvtd32matgueod4\",\"object\":\"chat.completion.chunk\",\"created\":1754623426,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"\\n\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-0zp7mnyauvtd32matgueod4\",\"object\":\"chat.completion.chunk\",\"created\":1754623426,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-0zp7mnyauvtd32matgueod4\",\"object\":\"chat.completion.chunk\",\"created\":1754623426,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{},\"logprobs\":null,\"finish_reason\":\"stop\"}]}\n\ndata: {\"id\":\"chatcmpl-0zp7mnyauvtd32matgueod4\",\"object\":\"chat.completion.chunk\",\"created\":1754623426,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[],\"usage\":{\"prompt_tokens\":111,\"completion_tokens\":4,\"total_tokens\":115}}\n\ndata: [DONE]\n\n","content_length":-1,"duration_ms":6,"error":null}
{"time":"2025-08-07T23:23:47.205401-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:23:46 GMT"],"X-Powered-By":["Express"]},"body":"event: error\ndata: {\"error\":{\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"},\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}\n\n","content_length":-1,"duration_ms":9,"error":null}
{"time":"2025-08-07T23:23:47.205588-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:23:47.205652-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:23:49.607335-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - README.md\\n  - boot.sh\\n  - main.fish\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - opencode/\\n        - opencode.json\\n      - git/\\n        - config\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n      - crush/\\n        - crush.json\\n      - vim/\\n        - vimrc\\n      - tofi/\\n        - config\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n        - style.css\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - defaults.fish\\n      - macos.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n  - doc/\\n    - flow.txt\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:23:49.643634-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:23:49 GMT"],"X-Powered-By":["Express"]},"body":"event: error\ndata: {\"error\":{\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"},\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}\n\n","content_length":-1,"duration_ms":4,"error":null}
{"time":"2025-08-07T23:23:49.64376-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:23:49.64379-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:23:54.448039-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - README.md\\n  - boot.sh\\n  - main.fish\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - opencode/\\n        - opencode.json\\n      - git/\\n        - config\\n      - ghostty/\\n        - config\\n      - fish/\\n        - config.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n      - crush/\\n        - crush.json\\n      - vim/\\n        - vimrc\\n      - tofi/\\n        - config\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n        - style.css\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - defaults.fish\\n      - macos.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n  - doc/\\n    - flow.txt\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:23:54.494523-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:23:54 GMT"],"X-Powered-By":["Express"]},"body":"event: error\ndata: {\"error\":{\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"},\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}\n\n","content_length":-1,"duration_ms":4,"error":null}
{"time":"2025-08-07T23:23:54.494664-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:23:54.494716-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:23:58.972678-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Cancel","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":241},"msg":"Request cancellation initiated","session_id":"4a9fa2a1-e23a-41d9-bfaf-50b3d92b57ff"}
{"time":"2025-08-07T23:23:58.972744-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"permissions"}
{"time":"2025-08-07T23:23:58.972768-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"mcp"}
{"time":"2025-08-07T23:23:58.97278-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"history"}
{"time":"2025-08-07T23:23:58.972793-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"sessions"}
{"time":"2025-08-07T23:23:58.972764-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).processGeneration","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":420},"msg":"Result","message":"","toolResults":null}
{"time":"2025-08-07T23:23:58.972803-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"coderAgent"}
{"time":"2025-08-07T23:23:58.972794-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"permissions-notifications"}
{"time":"2025-08-07T23:23:58.972825-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"lsp"}
{"time":"2025-08-07T23:23:58.972801-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"messages"}
{"time":"2025-08-07T23:23:58.972898-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).Subscribe.func2","file":"/home/runner/work/crush/crush/internal/app/app.go","line":291},"msg":"Cancelling TUI message handler"}
{"time":"2025-08-07T23:23:58.972924-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).Subscribe","file":"/home/runner/work/crush/crush/internal/app/app.go","line":300},"msg":"TUI message handler shutting down"}
{"time":"2025-08-07T23:25:34.001619-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:25:34.002574-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:25:34.002583-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:25:34.002607-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T23:25:34.078965-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:25:34.522227-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA foreign_keys = ON;"}
{"time":"2025-08-07T23:25:34.524183-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA journal_mode = WAL;"}
{"time":"2025-08-07T23:25:34.524203-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA page_size = 4096;"}
{"time":"2025-08-07T23:25:34.524215-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA cache_size = -8000;"}
{"time":"2025-08-07T23:25:34.524226-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA synchronous = NORMAL;"}
{"time":"2025-08-07T23:25:34.524391-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T23:25:34.524424-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T23:25:34.526236-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T23:25:34.526306-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T23:25:34.527903-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T23:25:34.527933-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T23:25:35.955757-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Run.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":337},"msg":"Request started","sessionID":"4761c48e-ab5d-4567-b3de-05df88764589"}
{"time":"2025-08-07T23:25:35.958972-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nhi\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:25:35.960675-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - README.md\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - boot.sh\\n  - main.fish\\n  - init/\\n    - lib.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - defaults.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - macos.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - ghostty/\\n        - config\\n      - git/\\n      - fish/\\n        - config.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - crush/\\n        - crush.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - vim/\\n        - vimrc\\n      - opencode/\\n        - opencode.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n      - zed/\\n        - settings.json\\n  - archive/\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:25:36.240276-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:25:35 GMT"],"X-Powered-By":["Express"]},"body":"data: {\"id\":\"chatcmpl-0tuv56obwes8ealieebtdy\",\"object\":\"chat.completion.chunk\",\"created\":1754623535,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{\"role\":\"assistant\",\"content\":\"Simple\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-0tuv56obwes8ealieebtdy\",\"object\":\"chat.completion.chunk\",\"created\":1754623535,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" greeting\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-0tuv56obwes8ealieebtdy\",\"object\":\"chat.completion.chunk\",\"created\":1754623535,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"\\n\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-0tuv56obwes8ealieebtdy\",\"object\":\"chat.completion.chunk\",\"created\":1754623535,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-0tuv56obwes8ealieebtdy\",\"object\":\"chat.completion.chunk\",\"created\":1754623535,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{},\"logprobs\":null,\"finish_reason\":\"stop\"}]}\n\ndata: {\"id\":\"chatcmpl-0tuv56obwes8ealieebtdy\",\"object\":\"chat.completion.chunk\",\"created\":1754623535,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[],\"usage\":{\"prompt_tokens\":111,\"completion_tokens\":4,\"total_tokens\":115}}\n\ndata: [DONE]\n\n","content_length":-1,"duration_ms":6,"error":null}
{"time":"2025-08-07T23:25:36.267199-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:25:35 GMT"],"X-Powered-By":["Express"]},"body":"event: error\ndata: {\"error\":{\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"},\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}\n\n","content_length":-1,"duration_ms":8,"error":null}
{"time":"2025-08-07T23:25:36.267268-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:25:36.267283-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:25:38.668545-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - README.md\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - boot.sh\\n  - main.fish\\n  - init/\\n    - lib.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - defaults.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - macos.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - ghostty/\\n        - config\\n      - git/\\n      - fish/\\n        - config.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - crush/\\n        - crush.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - vim/\\n        - vimrc\\n      - opencode/\\n        - opencode.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n      - zed/\\n        - settings.json\\n  - archive/\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:25:38.703167-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:25:38 GMT"],"X-Powered-By":["Express"]},"body":"event: error\ndata: {\"error\":{\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"},\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}\n\n","content_length":-1,"duration_ms":2,"error":null}
{"time":"2025-08-07T23:25:38.703434-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:25:38.703488-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:25:43.508057-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - README.md\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - boot.sh\\n  - main.fish\\n  - init/\\n    - lib.fish\\n    - link.fish\\n    - darwin/\\n      - brew.fish\\n      - defaults.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - macos.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - ghostty/\\n        - config\\n      - git/\\n      - fish/\\n        - config.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - crush/\\n        - crush.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - vim/\\n        - vimrc\\n      - opencode/\\n        - opencode.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n      - zed/\\n        - settings.json\\n  - archive/\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:25:43.561951-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:25:43 GMT"],"X-Powered-By":["Express"]},"body":"event: error\ndata: {\"error\":{\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"},\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}\n\n","content_length":-1,"duration_ms":6,"error":null}
{"time":"2025-08-07T23:25:43.562019-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:25:43.562032-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:25:50.985904-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Cancel","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":241},"msg":"Request cancellation initiated","session_id":"4761c48e-ab5d-4567-b3de-05df88764589"}
{"time":"2025-08-07T23:25:50.985971-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"permissions"}
{"time":"2025-08-07T23:25:50.985997-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).processGeneration","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":420},"msg":"Result","message":"","toolResults":null}
{"time":"2025-08-07T23:25:50.986017-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"mcp"}
{"time":"2025-08-07T23:25:50.98608-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"coderAgent"}
{"time":"2025-08-07T23:25:50.986105-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"sessions"}
{"time":"2025-08-07T23:25:50.986044-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"permissions-notifications"}
{"time":"2025-08-07T23:25:50.986074-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"history"}
{"time":"2025-08-07T23:25:50.986102-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"lsp"}
{"time":"2025-08-07T23:25:50.986098-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"messages"}
{"time":"2025-08-07T23:25:50.986191-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).Subscribe.func2","file":"/home/runner/work/crush/crush/internal/app/app.go","line":291},"msg":"Cancelling TUI message handler"}
{"time":"2025-08-07T23:25:50.986214-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).Subscribe","file":"/home/runner/work/crush/crush/internal/app/app.go","line":300},"msg":"TUI message handler shutting down"}
{"time":"2025-08-07T23:26:05.548734-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:26:05.555074-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:26:05.555101-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:26:05.55877-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T23:26:05.720501-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:26:09.688602-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":48},"msg":"Failed to set pragma","PRAGMA foreign_keys = ON;":"context canceled"}
{"time":"2025-08-07T23:26:09.688652-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":48},"msg":"Failed to set pragma","PRAGMA journal_mode = WAL;":"context canceled"}
{"time":"2025-08-07T23:26:09.68866-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":48},"msg":"Failed to set pragma","PRAGMA page_size = 4096;":"context canceled"}
{"time":"2025-08-07T23:26:09.688666-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":48},"msg":"Failed to set pragma","PRAGMA cache_size = -8000;":"context canceled"}
{"time":"2025-08-07T23:26:09.688671-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":48},"msg":"Failed to set pragma","PRAGMA synchronous = NORMAL;":"context canceled"}
{"time":"2025-08-07T23:26:09.732013-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T23:26:09.732077-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T23:26:09.840621-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T23:26:09.840704-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T23:26:09.845241-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T23:26:09.845263-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T23:26:09.846396-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/cmd.init.func2","file":"/home/runner/work/crush/crush/internal/cmd/root.go","line":75},"msg":"TUI run error","error":"program was killed: context canceled"}
{"time":"2025-08-07T23:26:12.500877-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:26:12.556212-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:26:12.556244-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:26:12.563887-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T23:26:12.791894-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:26:13.46171-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA foreign_keys = ON;"}
{"time":"2025-08-07T23:26:13.463834-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA journal_mode = WAL;"}
{"time":"2025-08-07T23:26:13.463865-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA page_size = 4096;"}
{"time":"2025-08-07T23:26:13.463877-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA cache_size = -8000;"}
{"time":"2025-08-07T23:26:13.463887-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA synchronous = NORMAL;"}
{"time":"2025-08-07T23:26:13.464062-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T23:26:13.4641-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T23:26:13.466035-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T23:26:13.466115-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T23:26:13.467874-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T23:26:13.467919-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T23:26:15.225661-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Run.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":337},"msg":"Request started","sessionID":"6af6b714-38cd-4659-8ce1-270819159198"}
{"time":"2025-08-07T23:26:15.227073-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nhi\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:26:15.227549-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - README.md\\n  - boot.sh\\n  - main.fish\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - git/\\n        - config\\n      - crush/\\n        - crush.json\\n      - ghostty/\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n      - fish/\\n        - config.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n      - opencode/\\n        - opencode.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - vim/\\n        - vimrc\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - darwin/\\n      - brew.fish\\n      - defaults.fish\\n      - macos.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n    - link.fish\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:26:15.510501-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:26:15 GMT"],"X-Powered-By":["Express"]},"body":"data: {\"id\":\"chatcmpl-owbkg6gkta91lm28uqszda\",\"object\":\"chat.completion.chunk\",\"created\":1754623575,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{\"role\":\"assistant\",\"content\":\"Simple\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-owbkg6gkta91lm28uqszda\",\"object\":\"chat.completion.chunk\",\"created\":1754623575,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" greeting\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-owbkg6gkta91lm28uqszda\",\"object\":\"chat.completion.chunk\",\"created\":1754623575,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"\\n\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-owbkg6gkta91lm28uqszda\",\"object\":\"chat.completion.chunk\",\"created\":1754623575,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-owbkg6gkta91lm28uqszda\",\"object\":\"chat.completion.chunk\",\"created\":1754623575,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[{\"index\":0,\"delta\":{},\"logprobs\":null,\"finish_reason\":\"stop\"}]}\n\ndata: {\"id\":\"chatcmpl-owbkg6gkta91lm28uqszda\",\"object\":\"chat.completion.chunk\",\"created\":1754623575,\"model\":\"google/gemma-3n-e4b\",\"system_fingerprint\":\"google/gemma-3n-e4b\",\"choices\":[],\"usage\":{\"prompt_tokens\":111,\"completion_tokens\":4,\"total_tokens\":115}}\n\ndata: [DONE]\n\n","content_length":-1,"duration_ms":5,"error":null}
{"time":"2025-08-07T23:26:15.53779-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:26:15 GMT"],"X-Powered-By":["Express"]},"body":"event: error\ndata: {\"error\":{\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"},\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}\n\n","content_length":-1,"duration_ms":8,"error":null}
{"time":"2025-08-07T23:26:15.537997-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:26:15.538064-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:26:17.944351-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - README.md\\n  - boot.sh\\n  - main.fish\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - git/\\n        - config\\n      - crush/\\n        - crush.json\\n      - ghostty/\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n      - fish/\\n        - config.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n      - opencode/\\n        - opencode.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - vim/\\n        - vimrc\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - darwin/\\n      - brew.fish\\n      - defaults.fish\\n      - macos.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n    - link.fish\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:26:18.000415-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:26:17 GMT"],"X-Powered-By":["Express"]},"body":"event: error\ndata: {\"error\":{\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"},\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}\n\n","content_length":-1,"duration_ms":8,"error":null}
{"time":"2025-08-07T23:26:18.000558-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:26:18.000594-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:26:22.804678-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - README.md\\n  - boot.sh\\n  - main.fish\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - git/\\n        - config\\n      - crush/\\n        - crush.json\\n      - ghostty/\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n      - fish/\\n        - config.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n      - opencode/\\n        - opencode.json\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - vim/\\n        - vimrc\\n      - zed/\\n        - settings.json\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - tofi/\\n        - config\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - darwin/\\n      - brew.fish\\n      - defaults.fish\\n      - macos.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n    - link.fish\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"}],\"model\":\"google/gemma-3n-e4b\",\"max_tokens\":20000,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:26:22.855153-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:26:22 GMT"],"X-Powered-By":["Express"]},"body":"event: error\ndata: {\"error\":{\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"},\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}\n\n","content_length":-1,"duration_ms":7,"error":null}
{"time":"2025-08-07T23:26:22.855294-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"The number of tokens to keep from the initial prompt is greater than the context length. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:26:22.855322-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:26:26.980801-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Cancel","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":241},"msg":"Request cancellation initiated","session_id":"6af6b714-38cd-4659-8ce1-270819159198"}
{"time":"2025-08-07T23:26:26.98087-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"mcp"}
{"time":"2025-08-07T23:26:26.980871-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).processGeneration","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":420},"msg":"Result","message":"","toolResults":null}
{"time":"2025-08-07T23:26:26.980901-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"sessions"}
{"time":"2025-08-07T23:26:26.980897-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"history"}
{"time":"2025-08-07T23:26:26.980922-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"messages"}
{"time":"2025-08-07T23:26:26.98093-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"coderAgent"}
{"time":"2025-08-07T23:26:26.980914-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"permissions-notifications"}
{"time":"2025-08-07T23:26:26.980946-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"permissions"}
{"time":"2025-08-07T23:26:26.980943-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"lsp"}
{"time":"2025-08-07T23:26:26.981032-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).Subscribe.func2","file":"/home/runner/work/crush/crush/internal/app/app.go","line":291},"msg":"Cancelling TUI message handler"}
{"time":"2025-08-07T23:26:26.98107-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).Subscribe","file":"/home/runner/work/crush/crush/internal/app/app.go","line":300},"msg":"TUI message handler shutting down"}
{"time":"2025-08-07T23:28:25.708923-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:28:25.710574-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:28:25.710602-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:28:25.710761-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T23:28:25.922498-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:28:26.243516-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA foreign_keys = ON;"}
{"time":"2025-08-07T23:28:26.247744-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA journal_mode = WAL;"}
{"time":"2025-08-07T23:28:26.247765-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA page_size = 4096;"}
{"time":"2025-08-07T23:28:26.247777-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA cache_size = -8000;"}
{"time":"2025-08-07T23:28:26.247786-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA synchronous = NORMAL;"}
{"time":"2025-08-07T23:28:26.248036-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T23:28:26.249089-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T23:28:26.251844-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T23:28:26.251977-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T23:28:26.253667-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T23:28:26.253692-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T23:28:28.201328-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Run.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":337},"msg":"Request started","sessionID":"cda4b925-f399-4065-8bdd-7ffca17d95c1"}
{"time":"2025-08-07T23:28:28.207658-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nhi\",\"role\":\"user\"}],\"model\":\"openai/gpt-oss-20b\",\"max_tokens\":4096,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:28:28.210055-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - README.md\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - git/\\n        - config\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - ghostty/\\n        - config\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - fish/\\n        - config.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n      - crush/\\n        - crush.json\\n      - tofi/\\n        - config\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - zed/\\n        - settings.json\\n      - vim/\\n        - vimrc\\n      - opencode/\\n        - opencode.json\\n  - boot.sh\\n  - init/\\n    - lib.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n  - main.fish\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"}],\"model\":\"openai/gpt-oss-20b\",\"max_tokens\":4096,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:28:31.082858-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:28:28 GMT"],"X-Powered-By":["Express"]},"body":"data: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"role\":\"assistant\",\"reasoning_content\":\"User\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" says\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" \\\"\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"Generate\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" a\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" concise\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" title\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" for\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" the\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" following\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" content\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\":\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" hi\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"\\\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" So\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" title\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" summar\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"izing\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" content\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" \\\"\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"hi\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"\\\"\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" maybe\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" \\\"\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"Greeting\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"\\\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" Must\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" be\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" <=\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"50\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" chars\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\",\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" one\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" line\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" No\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" quotes\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" or\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" col\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"ons\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" Just\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" output\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" title\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"Greeting\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{},\"logprobs\":null,\"finish_reason\":\"stop\"}]}\n\ndata: {\"id\":\"chatcmpl-crjqxdzve1ox8akdsta0gi\",\"object\":\"chat.completion.chunk\",\"created\":1754623708,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[],\"usage\":{\"prompt_tokens\":172,\"completion_tokens\":56,\"total_tokens\":228}}\n\ndata: [DONE]\n\n","content_length":-1,"duration_ms":6,"error":null}
{"time":"2025-08-07T23:28:31.252298-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:28:28 GMT"],"X-Powered-By":["Express"]},"body":"event: error\ndata: {\"error\":{\"message\":\"Trying to keep the first 10680 tokens when context the overflows. However, the model is loaded with context length of only 4096 tokens, which is not enough. Try to load the model with a larger context length, or provide a shorter input\"},\"message\":\"Trying to keep the first 10680 tokens when context the overflows. However, the model is loaded with context length of only 4096 tokens, which is not enough. Try to load the model with a larger context length, or provide a shorter input\"}\n\n","content_length":-1,"duration_ms":9,"error":null}
{"time":"2025-08-07T23:28:31.252465-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"Trying to keep the first 10680 tokens when context the overflows. However, the model is loaded with context length of only 4096 tokens, which is not enough. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:28:31.252531-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:28:33.658067-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - README.md\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - git/\\n        - config\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - ghostty/\\n        - config\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - fish/\\n        - config.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n      - crush/\\n        - crush.json\\n      - tofi/\\n        - config\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - zed/\\n        - settings.json\\n      - vim/\\n        - vimrc\\n      - opencode/\\n        - opencode.json\\n  - boot.sh\\n  - init/\\n    - lib.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n  - main.fish\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"}],\"model\":\"openai/gpt-oss-20b\",\"max_tokens\":4096,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:28:33.836349-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:28:33 GMT"],"X-Powered-By":["Express"]},"body":"event: error\ndata: {\"error\":{\"message\":\"Trying to keep the first 10680 tokens when context the overflows. However, the model is loaded with context length of only 4096 tokens, which is not enough. Try to load the model with a larger context length, or provide a shorter input\"},\"message\":\"Trying to keep the first 10680 tokens when context the overflows. However, the model is loaded with context length of only 4096 tokens, which is not enough. Try to load the model with a larger context length, or provide a shorter input\"}\n\n","content_length":-1,"duration_ms":7,"error":null}
{"time":"2025-08-07T23:28:33.836522-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"Trying to keep the first 10680 tokens when context the overflows. However, the model is loaded with context length of only 4096 tokens, which is not enough. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:28:33.836562-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:28:38.639796-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - README.md\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - git/\\n        - config\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - ghostty/\\n        - config\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - fish/\\n        - config.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n      - crush/\\n        - crush.json\\n      - tofi/\\n        - config\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - zed/\\n        - settings.json\\n      - vim/\\n        - vimrc\\n      - opencode/\\n        - opencode.json\\n  - boot.sh\\n  - init/\\n    - lib.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n  - main.fish\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"}],\"model\":\"openai/gpt-oss-20b\",\"max_tokens\":4096,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:28:38.812606-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:28:38 GMT"],"X-Powered-By":["Express"]},"body":"event: error\ndata: {\"error\":{\"message\":\"Trying to keep the first 10680 tokens when context the overflows. However, the model is loaded with context length of only 4096 tokens, which is not enough. Try to load the model with a larger context length, or provide a shorter input\"},\"message\":\"Trying to keep the first 10680 tokens when context the overflows. However, the model is loaded with context length of only 4096 tokens, which is not enough. Try to load the model with a larger context length, or provide a shorter input\"}\n\n","content_length":-1,"duration_ms":8,"error":null}
{"time":"2025-08-07T23:28:38.812778-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"Trying to keep the first 10680 tokens when context the overflows. However, the model is loaded with context length of only 4096 tokens, which is not enough. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:28:38.812813-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:28:48.418051-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - README.md\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n  - home/\\n    - .bashrc\\n    - .zshrc\\n    - .config/\\n      - git/\\n        - config\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - ghostty/\\n        - config\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - fish/\\n        - config.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n      - crush/\\n        - crush.json\\n      - tofi/\\n        - config\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - zed/\\n        - settings.json\\n      - vim/\\n        - vimrc\\n      - opencode/\\n        - opencode.json\\n  - boot.sh\\n  - init/\\n    - lib.fish\\n    - darwin/\\n      - brew.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n      - defaults.fish\\n      - macos.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - link.fish\\n  - main.fish\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"}],\"model\":\"openai/gpt-oss-20b\",\"max_tokens\":4096,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:28:48.5772-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:28:48 GMT"],"X-Powered-By":["Express"]},"body":"event: error\ndata: {\"error\":{\"message\":\"Trying to keep the first 10680 tokens when context the overflows. However, the model is loaded with context length of only 4096 tokens, which is not enough. Try to load the model with a larger context length, or provide a shorter input\"},\"message\":\"Trying to keep the first 10680 tokens when context the overflows. However, the model is loaded with context length of only 4096 tokens, which is not enough. Try to load the model with a larger context length, or provide a shorter input\"}\n\n","content_length":-1,"duration_ms":3,"error":null}
{"time":"2025-08-07T23:28:48.577347-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"received error while streaming: {\"message\":\"Trying to keep the first 10680 tokens when context the overflows. However, the model is loaded with context length of only 4096 tokens, which is not enough. Try to load the model with a larger context length, or provide a shorter input\"}","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:28:48.577375-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:28:52.322542-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Cancel","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":241},"msg":"Request cancellation initiated","session_id":"cda4b925-f399-4065-8bdd-7ffca17d95c1"}
{"time":"2025-08-07T23:28:52.322614-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"lsp"}
{"time":"2025-08-07T23:28:52.32264-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"permissions-notifications"}
{"time":"2025-08-07T23:28:52.322653-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"history"}
{"time":"2025-08-07T23:28:52.322662-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"mcp"}
{"time":"2025-08-07T23:28:52.322648-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"sessions"}
{"time":"2025-08-07T23:28:52.322673-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"messages"}
{"time":"2025-08-07T23:28:52.322681-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"coderAgent"}
{"time":"2025-08-07T23:28:52.322668-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"permissions"}
{"time":"2025-08-07T23:28:52.32276-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).Subscribe.func2","file":"/home/runner/work/crush/crush/internal/app/app.go","line":291},"msg":"Cancelling TUI message handler"}
{"time":"2025-08-07T23:28:52.322784-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).Subscribe","file":"/home/runner/work/crush/crush/internal/app/app.go","line":300},"msg":"TUI message handler shutting down"}
{"time":"2025-08-07T23:34:32.786687-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:34:32.788125-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:34:32.788135-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:34:32.788137-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T23:34:32.89526-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:34:33.317163-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA foreign_keys = ON;"}
{"time":"2025-08-07T23:34:33.321319-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA journal_mode = WAL;"}
{"time":"2025-08-07T23:34:33.321337-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA page_size = 4096;"}
{"time":"2025-08-07T23:34:33.321349-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA cache_size = -8000;"}
{"time":"2025-08-07T23:34:33.321357-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/db.Connect","file":"/home/runner/work/crush/crush/internal/db/connect.go","line":50},"msg":"Set pragma","pragma":"PRAGMA synchronous = NORMAL;"}
{"time":"2025-08-07T23:34:33.321574-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T23:34:33.321699-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T23:34:33.323976-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T23:34:33.324093-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T23:34:33.32629-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T23:34:33.326315-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T23:34:34.185009-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Run.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":337},"msg":"Request started","sessionID":"f925d435-9d63-4743-8515-2964a2de9e4a"}
{"time":"2025-08-07T23:34:34.188587-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"you will generate a short title based on the first message a user begins a conversation with\\n\\n- ensure it is not more than 50 characters long\\n- the title should be a summary of the user's message\\n- it should be one line long\\n- do not use quotes or colons\\n- the entire text you return will be used as the title\\n- never return anything that is more than one sentence (one line) long\\n\",\"role\":\"system\"},{\"content\":\"Generate a concise title for the following content:\\n\\nhi\",\"role\":\"user\"}],\"model\":\"openai/gpt-oss-20b\",\"max_tokens\":4096,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:34:34.191663-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - README.md\\n  - boot.sh\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - darwin/\\n      - brew.fish\\n      - defaults.fish\\n      - macos.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n    - link.fish\\n  - home/\\n    - .bashrc\\n    - .config/\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n      - ghostty/\\n        - config\\n      - crush/\\n        - crush.json\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - git/\\n        - config\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - opencode/\\n        - opencode.json\\n      - vim/\\n        - vimrc\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - zed/\\n        - settings.json\\n      - tofi/\\n        - config\\n    - .zshrc\\n  - main.fish\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"}],\"model\":\"openai/gpt-oss-20b\",\"max_tokens\":4096,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:34:38.097004-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:34:34 GMT"],"X-Powered-By":["Express"]},"body":"data: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"role\":\"assistant\",\"reasoning_content\":\"User\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" says\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" \\\"\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"Generate\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" a\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" concise\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" title\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" for\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" the\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" following\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" content\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\":\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" hi\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"\\\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" We\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" need\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" to\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" produce\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" a\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" short\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" title\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" summar\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"izing\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" \\\"\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"hi\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"\\\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" Title\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" <=\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"50\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" chars\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\",\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" single\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" line\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" No\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" quotes\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" or\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" col\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"ons\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" Just\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" a\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" sentence\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"?\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" Probably\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" just\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" \\\"\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"Greeting\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"\\\"\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" or\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" \\\"\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"Short\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" Greeting\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"\\\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" I'll\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" output\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" \\\"\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"Short\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" greeting\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\"\\\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"Short\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" greeting\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{},\"logprobs\":null,\"finish_reason\":\"stop\"}]}\n\ndata: {\"id\":\"chatcmpl-a1zn03j83gqk03okudjh\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[],\"usage\":{\"prompt_tokens\":172,\"completion_tokens\":72,\"total_tokens\":244}}\n\ndata: [DONE]\n\n","content_length":-1,"duration_ms":14,"error":null}
{"time":"2025-08-07T23:35:31.916129-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:34:34 GMT"],"X-Powered-By":["Express"]},"body":"data: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"role\":\"assistant\",\"reasoning_content\":\"User\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" says\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" hi\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" Just\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" greet\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" briefly\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"Hello\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"!\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" How\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" can\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" I\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" help\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" you\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" today\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"?\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{},\"logprobs\":null,\"finish_reason\":\"stop\"}]}\n\ndata: {\"id\":\"chatcmpl-fx8bezf8dgleru94uyqv2c\",\"object\":\"chat.completion.chunk\",\"created\":1754624074,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[],\"usage\":{\"prompt_tokens\":10680,\"completion_tokens\":27,\"total_tokens\":10707}}\n\ndata: [DONE]\n\n","content_length":-1,"duration_ms":20,"error":null}
{"time":"2025-08-07T23:35:31.923288-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).processGeneration","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":420},"msg":"Result","message":"end_turn","toolResults":null}
{"time":"2025-08-07T23:35:31.923427-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Run.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":349},"msg":"Request completed","sessionID":"f925d435-9d63-4743-8515-2964a2de9e4a"}
{"time":"2025-08-07T23:37:06.270439-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are a helpful AI assistant tasked with summarizing conversations.\\n\\nWhen asked to summarize, provide a detailed but concise summary of the conversation.\\nFocus on information that would be helpful for continuing the conversation, including:\\n\\n- What was done\\n- What is currently being worked on\\n- Which files are being modified\\n- What needs to be done next\\n\\nYour summary should be comprehensive enough to provide context but concise enough to be quickly understood.\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"},{\"content\":\"Hello! How can I help you today?\",\"role\":\"assistant\"},{\"content\":\"Provide a detailed but concise summary of our conversation above. Focus on information that would be helpful for continuing the conversation, including what we did, what we're doing, which files we're working on, and what we're going to do next.\",\"role\":\"user\"}],\"model\":\"openai/gpt-oss-20b\",\"max_tokens\":4096,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:37:11.22227-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:37:06 GMT"],"X-Powered-By":["Express"]},"body":"data: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"role\":\"assistant\",\"reasoning_content\":\"User\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" wants\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" summary\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" There's\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" no\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" file\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" work\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" Just\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" greeting\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"**\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"Conversation\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" Summary\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"**\\n\\n\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"-\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" **\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"What\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" was\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" done\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\":**\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"  \\n\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" \"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" -\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" The\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" user\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" greeted\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" the\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" assistant\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" with\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" “\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"hi\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\".”\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"  \\n\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" \"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" -\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" The\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" assistant\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" responded\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" with\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" a\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" friendly\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" greeting\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" and\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" offered\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" help\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\".\\n\\n\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"-\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" **\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"Current\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" status\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\":**\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"  \\n\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" \"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" -\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" No\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" tasks\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" or\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" files\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" have\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" been\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" started\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" yet\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\";\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" the\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" conversation\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" is\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" at\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" its\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" initial\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" stage\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\".\\n\\n\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"-\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" **\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"Next\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" steps\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" (\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"if\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" any\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"):\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"**\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"  \\n\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" \"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" -\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" Await\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" further\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" instructions\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" from\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" the\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" user\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" to\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" determine\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" what\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" assistance\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" they\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" need\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"—\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"whether\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" it\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" involves\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" code\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\",\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" documentation\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\",\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" or\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" another\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" topic\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{},\"logprobs\":null,\"finish_reason\":\"stop\"}]}\n\ndata: {\"id\":\"chatcmpl-2bonj4jbuqftn8fjgb4bn\",\"object\":\"chat.completion.chunk\",\"created\":1754624226,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[],\"usage\":{\"prompt_tokens\":226,\"completion_tokens\":119,\"total_tokens\":345}}\n\ndata: [DONE]\n\n","content_length":-1,"duration_ms":8,"error":null}
{"time":"2025-08-07T23:37:15.510066-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Run.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":337},"msg":"Request started","sessionID":"f925d435-9d63-4743-8515-2964a2de9e4a"}
{"time":"2025-08-07T23:37:15.515165-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - README.md\\n  - boot.sh\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - darwin/\\n      - brew.fish\\n      - defaults.fish\\n      - macos.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n    - link.fish\\n  - home/\\n    - .bashrc\\n    - .config/\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n      - ghostty/\\n        - config\\n      - crush/\\n        - crush.json\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - git/\\n        - config\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - opencode/\\n        - opencode.json\\n      - vim/\\n        - vimrc\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - zed/\\n        - settings.json\\n      - tofi/\\n        - config\\n    - .zshrc\\n  - main.fish\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"**Conversation Summary**\\n\\n- **What was done:**  \\n  - The user greeted the assistant with “hi.”  \\n  - The assistant responded with a friendly greeting and offered help.\\n\\n- **Current status:**  \\n  - No tasks or files have been started yet; the conversation is at its initial stage.\\n\\n- **Next steps (if any):**  \\n  - Await further instructions from the user to determine what assistance they need—whether it involves code, documentation, or another topic.\\n\\n**Current working directory of the persistent shell**\\n\\n/Users/roly/Developer/env\",\"role\":\"user\"},{\"content\":\"what is this project about?\",\"role\":\"user\"}],\"model\":\"openai/gpt-oss-20b\",\"max_tokens\":4096,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:38:12.772284-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:37:15 GMT"],"X-Powered-By":["Express"]},"body":"data: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"role\":\"assistant\",\"reasoning_content\":\"Need\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" explain\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" Probably\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" read\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" README\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\".md\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"id\":\"375663523\",\"type\":\"function\",\"function\":{\"name\":\"view\",\"arguments\":\"\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"{\\\"\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"file\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"_path\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"\\\":\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"\\\"/\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"Users\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"/\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"ro\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"ly\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"/\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"Developer\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"/env\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"/\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"README\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\".md\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"\\\",\\\"\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"limit\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"\\\":\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"200\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"tool_calls\":[{\"index\":0,\"type\":\"function\",\"function\":{\"arguments\":\"}\"}}]},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{},\"logprobs\":null,\"finish_reason\":\"tool_calls\"}]}\n\ndata: {\"id\":\"chatcmpl-xreq1c5u7xcz8mqd36wwfj\",\"object\":\"chat.completion.chunk\",\"created\":1754624235,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[],\"usage\":{\"prompt_tokens\":10800,\"completion_tokens\":46,\"total_tokens\":10846}}\n\ndata: [DONE]\n\n","content_length":-1,"duration_ms":7,"error":null}
{"time":"2025-08-07T23:38:12.772917-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).processEvent","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":627},"msg":"Tool call started","toolCall":{"id":"375663523","name":"view","input":"","type":"","finished":false}}
{"time":"2025-08-07T23:38:12.774555-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).processGeneration","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":420},"msg":"Result","message":"tool_use","toolResults":{"ID":"d9f051c2-e894-4099-9bc7-022d4e175f6f","Role":"tool","SessionID":"f925d435-9d63-4743-8515-2964a2de9e4a","Parts":[{"tool_call_id":"375663523","name":"","content":"<file>\n     1|# env\n     2|\n     3|An idempotent, (mostly) unattended tool to configure macOS with everything I need to be productive. Essential packages are installed and configured to create my development environment.\n     4|\n     5|This project should be considered personal software and was developed for an audience of one.\n     6|\n     7|## Prerequisites\n     8|\n     9|- macOS\n    10|- internet access\n    11|- sudo\n    12|\n    13|## Usage\n    14|\n    15|`sh -c $(curl -fsSL env.roly.sh)`\n    16|`wget -O- env.roly.sh`\n    17|\n    18|## Acknowledgements\n    19|\n    20|- Omakub, Omarchy, Crucible - spiritual kinship, inspiration\n    21|- Homebrew - a pillar in macOS computing\n    22|- Gum - a crucial utility that transformed the UX of this project\n    23|\n    24|## TODO\n    25|\n    26|- make README nicer and add links to Acknowledgements\n    27|- support at least one Linux distro (likely Arch)\n</file>\n","metadata":"{\"file_path\":\"/Users/roly/Developer/env/README.md\",\"content\":\"# env\\n\\nAn idempotent, (mostly) unattended tool to configure macOS with everything I need to be productive. Essential packages are installed and configured to create my development environment.\\n\\nThis project should be considered personal software and was developed for an audience of one.\\n\\n## Prerequisites\\n\\n- macOS\\n- internet access\\n- sudo\\n\\n## Usage\\n\\n`sh -c $(curl -fsSL env.roly.sh)`\\n`wget -O- env.roly.sh`\\n\\n## Acknowledgements\\n\\n- Omakub, Omarchy, Crucible - spiritual kinship, inspiration\\n- Homebrew - a pillar in macOS computing\\n- Gum - a crucial utility that transformed the UX of this project\\n\\n## TODO\\n\\n- make README nicer and add links to Acknowledgements\\n- support at least one Linux distro (likely Arch)\"}","is_error":false},{"reason":"stop","time":0}],"Model":"","Provider":"lmstudio","CreatedAt":1754624292,"UpdatedAt":1754624292}}
{"time":"2025-08-07T23:38:12.776684-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are Crush, an interactive CLI tool that helps users with software engineering tasks. Use the instructions below and the tools available to you to assist the user.\\n\\nIMPORTANT: Before you begin work, think about what the code you're editing is supposed to do based on the filenames directory structure.\\n\\n# Memory\\n\\nIf the current working directory contains a file called CRUSH.md, it will be automatically added to your context. This file serves multiple purposes:\\n\\n1. Storing frequently used bash commands (build, test, lint, etc.) so you can use them without searching each time\\n2. Recording the user's code style preferences (naming conventions, preferred libraries, etc.)\\n3. Maintaining useful information about the codebase structure and organization\\n\\nWhen you spend time searching for commands to typecheck, lint, build, or test, you should ask the user if it's okay to add those commands to CRUSH.md. Similarly, when learning about code style preferences or important codebase information, ask if it's okay to add that to CRUSH.md so you can remember it for next time.\\n\\n# Tone and style\\n\\nYou should be concise, direct, and to the point. When you run a non-trivial bash command, you should explain what the command does and why you are running it, to make sure the user understands what you are doing (this is especially important when you are running a command that will make changes to the user's system).\\nRemember that your output will be displayed on a command line interface. Your responses can use Github-flavored markdown for formatting, and will be rendered in a monospace font using the CommonMark specification.\\nOutput text to communicate with the user; all text you output outside of tool use is displayed to the user. Only use tools to complete tasks. Never use tools like Bash or code comments as means to communicate with the user during the session.\\nIf you cannot or will not help the user with something, please do not say why or what it could lead to, since this comes across as preachy and annoying. Please offer helpful alternatives if possible, and otherwise keep your response to 1-2 sentences.\\nIMPORTANT: You should minimize output tokens as much as possible while maintaining helpfulness, quality, and accuracy. Only address the specific query or task at hand, avoiding tangential information unless absolutely critical for completing the request. If you can answer in 1-3 sentences or a short paragraph, please do.\\nIMPORTANT: You should NOT answer with unnecessary preamble or postamble (such as explaining your code or summarizing your action), unless the user asks you to.\\nIMPORTANT: Keep your responses short, since they will be displayed on a command line interface. You MUST answer concisely with fewer than 4 lines (not including tool use or code generation), unless user asks for detail. Answer the user's question directly, without elaboration, explanation, or details. One word answers are best. Avoid introductions, conclusions, and explanations. You MUST avoid text before/after your response, such as \\\"The answer is \\u003canswer\\u003e.\\\", \\\"Here is the content of the file...\\\" or \\\"Based on the information provided, the answer is...\\\" or \\\"Here is what I will do next...\\\". Here are some examples to demonstrate appropriate verbosity:\\n\\u003cexample\\u003e\\nuser: 2 + 2\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what is 2+2?\\nassistant: 4\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: is 11 a prime number?\\nassistant: true\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to list files in the current directory?\\nassistant: ls\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what command should I run to watch files in the current directory?\\nassistant: [use the ls tool to list the files in the current directory, then read docs/commands in the relevant file to find out how to watch files]\\nnpm run dev\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: How many golf balls fit inside a jetta?\\nassistant: 150000\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: what files are in the directory src/?\\nassistant: [runs ls and sees foo.c, bar.c, baz.c]\\nuser: which file contains the implementation of foo?\\nassistant: src/foo.c\\n\\u003c/example\\u003e\\n\\n\\u003cexample\\u003e\\nuser: write tests for new feature\\nassistant: [uses grep and glob search tools to find where similar tests are defined, uses concurrent read file tool use blocks in one tool call to read relevant files at the same time, uses edit file tool to write new tests]\\n\\u003c/example\\u003e\\n\\n# Proactiveness\\n\\nYou are allowed to be proactive, but only when the user asks you to do something. You should strive to strike a balance between:\\n\\n1. Doing the right thing when asked, including taking actions and follow-up actions\\n2. Not surprising the user with actions you take without asking\\n   For example, if the user asks you how to approach something, you should do your best to answer their question first, and not immediately jump into taking actions.\\n3. Do not add additional code explanation summary unless requested by the user. After working on a file, just stop, rather than providing an explanation of what you did.\\n\\n# Following conventions\\n\\nWhen making changes to files, first understand the file's code conventions. Mimic code style, use existing libraries and utilities, and follow existing patterns.\\n\\n- NEVER assume that a given library is available, even if it is well known. Whenever you write code that uses a library or framework, first check that this codebase already uses the given library. For example, you might look at neighboring files, or check the package.json (or cargo.toml, and so on depending on the language).\\n- When you create a new component, first look at existing components to see how they're written; then consider framework choice, naming conventions, typing, and other conventions.\\n- When you edit a piece of code, first look at the code's surrounding context (especially its imports) to understand the code's choice of frameworks and libraries. Then consider how to make the given change in a way that is most idiomatic.\\n- Always follow security best practices. Never introduce code that exposes or logs secrets and keys. Never commit secrets or keys to the repository.\\n\\n# Code style\\n\\n- IMPORTANT: DO NOT ADD **_ANY_** COMMENTS unless asked\\n\\n# Doing tasks\\n\\nThe user will primarily request you perform software engineering tasks. This includes solving bugs, adding new functionality, refactoring code, explaining code, and more. For these tasks the following steps are recommended:\\n\\n1. Use the available search tools to understand the codebase and the user's query.\\n2. Implement the solution using all tools available to you\\n3. Verify the solution if possible with tests. NEVER assume specific test framework or test script. Check the README or search codebase to determine the testing approach.\\n4. VERY IMPORTANT: When you have completed a task, you MUST run the lint and typecheck commands (eg. npm run lint, npm run typecheck, ruff, etc.) if they were provided to you to ensure your code is correct. If you are unable to find the correct command, ask the user for the command to run and if they supply it, proactively suggest writing it to CRUSH.md so that you will know to run it next time.\\n\\nNEVER commit changes unless the user explicitly asks you to. It is VERY IMPORTANT to only commit when explicitly asked, otherwise the user will feel that you are being too proactive.\\n\\n# Tool usage policy\\n\\n- When doing file search, prefer to use the Agent tool in order to reduce context usage.\\n- IMPORTANT: All tools are executed in parallel when multiple tool calls are sent in a single message. Only send multiple tool calls when they are safe to run in parallel (no dependencies between them).\\n- IMPORTANT: The user does not see the full output of the tool responses, so if you need the output of the tool for the response make sure to summarize it for the user.\\n\\nVERY IMPORTANT NEVER use emojis in your responses.\\n\\nYou MUST answer concisely with fewer than 4 lines of text (not including tool use or code generation), unless user asks for detail.\\n\\n\\nHere is useful information about the environment you are running in:\\n\\u003cenv\\u003e\\nWorking directory: /Users/roly/Developer/env\\nIs directory a git repo: Yes\\nPlatform: darwin\\nToday's date: 8/7/2025\\n\\u003c/env\\u003e\\n\\u003cproject\\u003e\\n- /Users/roly/Developer/env/\\n  - .gitignore\\n  - doc/\\n    - flow.txt\\n    - mermaid.txt\\n  - README.md\\n  - boot.sh\\n  - init/\\n    - lib.fish\\n    - linux/\\n      - arch.fish\\n      - gnome.fish\\n      - hyprland.fish\\n    - darwin/\\n      - brew.fish\\n      - defaults.fish\\n      - macos.fish\\n      - doc/\\n        - dock.txt\\n        - hot-corners.txt\\n    - link.fish\\n  - home/\\n    - .bashrc\\n    - .config/\\n      - fish/\\n        - config.fish\\n        - functions/\\n          - bangbang.fish\\n          - dotdot.fish\\n          - mdcd.fish\\n          - pass.fish\\n          - touch.fish\\n        - prompt/\\n          - fish_mode_prompt.fish\\n          - fish_prompt.fish\\n          - fish_title.fish\\n          - hydro.fish\\n          - hydro_config.fish\\n          - ssh.fish\\n        - conf.d/\\n          - archive.fish\\n          - dotfiles.fish\\n          - git.fish\\n          - gum.fish\\n          - homebrew.fish\\n          - lift.fish\\n          - linux.fish\\n          - mac.fish\\n          - plugins.fish\\n      - ghostty/\\n        - config\\n      - crush/\\n        - crush.json\\n      - hammerspoon/\\n        - init.lua\\n        - lib/\\n          - app.lua\\n          - finder.lua\\n          - macos.lua\\n          - mouse.lua\\n          - reload.lua\\n          - space.lua\\n          - window.lua\\n      - git/\\n        - config\\n      - hypr/\\n        - hypridle.conf\\n        - hyprland.conf\\n        - hyprlock.conf\\n        - lid.sh\\n      - helix/\\n        - config.toml\\n        - themes/\\n          - catppuccin.toml\\n      - opencode/\\n        - opencode.json\\n      - vim/\\n        - vimrc\\n      - waybar/\\n        - config.jsonc\\n        - modules.json\\n        - style.css\\n        - bak/\\n          - config.jsonc\\n          - style.css\\n      - zed/\\n        - settings.json\\n      - tofi/\\n        - config\\n    - .zshrc\\n  - main.fish\\n  - archive/\\n    - init.sh\\n    - lib.sh\\n    - link.sh\\n\\n\\u003c/project\\u003e\\n\\t\\t\\n\",\"role\":\"system\"},{\"content\":\"**Conversation Summary**\\n\\n- **What was done:**  \\n  - The user greeted the assistant with “hi.”  \\n  - The assistant responded with a friendly greeting and offered help.\\n\\n- **Current status:**  \\n  - No tasks or files have been started yet; the conversation is at its initial stage.\\n\\n- **Next steps (if any):**  \\n  - Await further instructions from the user to determine what assistance they need—whether it involves code, documentation, or another topic.\\n\\n**Current working directory of the persistent shell**\\n\\n/Users/roly/Developer/env\",\"role\":\"user\"},{\"content\":\"what is this project about?\",\"role\":\"user\"},{\"tool_calls\":[{\"id\":\"375663523\",\"function\":{\"arguments\":\"{\\\"file_path\\\":\\\"/Users/roly/Developer/env/README.md\\\",\\\"limit\\\":200}\",\"name\":\"view\"},\"type\":\"function\"}],\"role\":\"assistant\"},{\"content\":\"\\u003cfile\\u003e\\n     1|# env\\n     2|\\n     3|An idempotent, (mostly) unattended tool to configure macOS with everything I need to be productive. Essential packages are installed and configured to create my development environment.\\n     4|\\n     5|This project should be considered personal software and was developed for an audience of one.\\n     6|\\n     7|## Prerequisites\\n     8|\\n     9|- macOS\\n    10|- internet access\\n    11|- sudo\\n    12|\\n    13|## Usage\\n    14|\\n    15|`sh -c $(curl -fsSL env.roly.sh)`\\n    16|`wget -O- env.roly.sh`\\n    17|\\n    18|## Acknowledgements\\n    19|\\n    20|- Omakub, Omarchy, Crucible - spiritual kinship, inspiration\\n    21|- Homebrew - a pillar in macOS computing\\n    22|- Gum - a crucial utility that transformed the UX of this project\\n    23|\\n    24|## TODO\\n    25|\\n    26|- make README nicer and add links to Acknowledgements\\n    27|- support at least one Linux distro (likely Arch)\\n\\u003c/file\\u003e\\n\",\"tool_call_id\":\"375663523\",\"role\":\"tool\"}],\"model\":\"openai/gpt-oss-20b\",\"max_tokens\":4096,\"stream_options\":{\"include_usage\":true},\"tools\":[{\"function\":{\"name\":\"bash\",\"description\":\"Executes a given bash command in a persistent shell session with optional timeout, ensuring proper handling and security measures.\\n\\nCROSS-PLATFORM SHELL SUPPORT:\\n* This tool uses a shell interpreter (mvdan/sh) that mimics the Bash language,\\n  so you should use Bash syntax in all platforms, including Windows.\\n  The most common shell builtins and core utils are available in Windows as\\n  well.\\n* Make sure to use forward slashes (/) as path separators in commands, even on\\n  Windows. Example: \\\"ls C:/foo/bar\\\" instead of \\\"ls C:\\\\foo\\\\bar\\\".\\n\\nBefore executing the command, please follow these steps:\\n\\n1. Directory Verification:\\n - If the command will create new directories or files, first use the LS tool to verify the parent directory exists and is the correct location\\n - For example, before running \\\"mkdir foo/bar\\\", first use LS to check that \\\"foo\\\" exists and is the intended parent directory\\n\\n2. Security Check:\\n - For security and to limit the threat of a prompt injection attack, some commands are limited or banned. If you use a disallowed command, you will receive an error message explaining the restriction. Explain the error to the User.\\n - Verify that the command is not one of the banned commands: alias, aria2c, axel, chrome, curl, curlie, firefox, http-prompt, httpie, links, lynx, nc, safari, scp, ssh, telnet, w3m, wget, xh, doas, su, sudo, apk, apt, apt-cache, apt-get, dnf, dpkg, emerge, home-manager, makepkg, opkg, pacman, paru, pkg, pkg_add, pkg_delete, portage, rpm, yay, yum, zypper, at, batch, chkconfig, crontab, fdisk, mkfs, mount, parted, service, systemctl, umount, firewall-cmd, ifconfig, ip, iptables, netstat, pfctl, route, ufw.\\n\\n3. Command Execution:\\n - After ensuring proper quoting, execute the command.\\n - Capture the output of the command.\\n\\n4. Output Processing:\\n - If the output exceeds 30000 characters, output will be truncated before being returned to you.\\n - Prepare the output for display to the user.\\n\\n5. Return Result:\\n - Provide the processed output of the command.\\n - If any errors occurred during execution, include those in the output.\\n - The result will also have metadata like the cwd (current working directory) at the end, included with \\u003ccwd\\u003e\\u003c/cwd\\u003e tags.\\n\\nUsage notes:\\n- The command argument is required.\\n- You can specify an optional timeout in milliseconds (up to 600000ms / 10 minutes). If not specified, commands will timeout after 30 minutes.\\n- VERY IMPORTANT: You MUST avoid using search commands like 'find' and 'grep'. Instead use Grep, Glob, or Agent tools to search. You MUST avoid read tools like 'cat', 'head', 'tail', and 'ls', and use FileRead and LS tools to read files.\\n- When issuing multiple commands, use the ';' or '\\u0026\\u0026' operator to separate them. DO NOT use newlines (newlines are ok in quoted strings).\\n- IMPORTANT: All commands share the same shell session. Shell state (environment variables, virtual environments, current directory, etc.) persist between commands. For example, if you set an environment variable as part of a command, the environment variable will persist for subsequent commands.\\n- Try to maintain your current working directory throughout the session by using absolute paths and avoiding usage of 'cd'. You may use 'cd' if the User explicitly requests it.\\n\\u003cgood-example\\u003e\\npytest /foo/bar/tests\\n\\u003c/good-example\\u003e\\n\\u003cbad-example\\u003e\\ncd /foo/bar \\u0026\\u0026 pytest tests\\n\\u003c/bad-example\\u003e\\n\\n# Committing changes with git\\n\\nWhen the user asks you to create a new git commit, follow these steps carefully:\\n\\n1. Start with a single message that contains exactly three tool_use blocks that do the following (it is VERY IMPORTANT that you send these tool_use blocks in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Run a git log command to see recent commit messages, so that you can follow this repository's commit message style.\\n\\n2. Use the git context at the start of this conversation to determine which files are relevant to your commit. Add relevant untracked files to the staging area. Do not commit files that were already modified at the start of this conversation, if they are not relevant to your commit.\\n\\n3. Analyze all staged changes (both previously staged and newly added) and draft a commit message. Wrap your analysis process in \\u003ccommit_analysis\\u003e tags:\\n\\n\\u003ccommit_analysis\\u003e\\n- List the files that have been changed or added\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Assess the impact of these changes on the overall project\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 sentences) commit message that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the message accurately reflects the changes and their purpose (i.e. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the message is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft message to ensure it accurately reflects the changes and their purpose\\n\\u003c/commit_analysis\\u003e\\n\\n4. Create the commit with a message ending with:\\n💘 Generated with Crush\\nCo-Authored-By: Crush \\u003ccrush@charm.land\\u003e\\n\\n- In order to ensure good formatting, ALWAYS pass the commit message via a HEREDOC, a la this example:\\n\\u003cexample\\u003e\\ngit commit -m \\\"$(cat \\u003c\\u003c'EOF'\\n Commit message here.\\n\\n 💘 Generated with Crush\\n Co-Authored-By: 💘 Crush \\u003ccrush@charm.land\\u003e\\n EOF\\n )\\\"\\n\\u003c/example\\u003e\\n\\n5. If the commit fails due to pre-commit hook changes, retry the commit ONCE to include these automated changes. If it fails again, it usually means a pre-commit hook is preventing the commit. If the commit succeeds but you notice that files were modified by the pre-commit hook, you MUST amend your commit to include them.\\n\\n6. Finally, run git status to make sure the commit succeeded.\\n\\nImportant notes:\\n- When possible, combine the \\\"git add\\\" and \\\"git commit\\\" commands into a single \\\"git commit -am\\\" command, to speed things up\\n- However, be careful not to stage files (e.g. with 'git add .') for commits that aren't part of the change, they may have untracked files they want to keep around, but not commit.\\n- NEVER update the git config\\n- DO NOT push to the remote repository\\n- IMPORTANT: Never use git commands with the -i flag (like git rebase -i or git add -i) since they require interactive input which is not supported.\\n- If there are no changes to commit (i.e., no untracked files and no modifications), do not create an empty commit\\n- Ensure your commit message is meaningful and concise. It should explain the purpose of the changes, not just describe them.\\n- Return an empty response - the user will see the git output directly\\n\\n# Creating pull requests\\nUse the gh command via the Bash tool for ALL GitHub-related tasks including working with issues, pull requests, checks, and releases. If given a Github URL use the gh command to get the information needed.\\n\\nIMPORTANT: When the user asks you to create a pull request, follow these steps carefully:\\n\\n1. Understand the current state of the branch. Remember to send a single message that contains multiple tool_use blocks (it is VERY IMPORTANT that you do this in a single message, otherwise it will feel slow to the user!):\\n - Run a git status command to see all untracked files.\\n - Run a git diff command to see both staged and unstaged changes that will be committed.\\n - Check if the current branch tracks a remote branch and is up to date with the remote, so you know if you need to push to the remote\\n - Run a git log command and 'git diff main...HEAD' to understand the full commit history for the current branch (from the time it diverged from the 'main' branch.)\\n\\n2. Create new branch if needed\\n\\n3. Commit changes if needed\\n\\n4. Push to remote with -u flag if needed\\n\\n5. Analyze all changes that will be included in the pull request, making sure to look at all relevant commits (not just the latest commit, but all commits that will be included in the pull request!), and draft a pull request summary. Wrap your analysis process in \\u003cpr_analysis\\u003e tags:\\n\\n\\u003cpr_analysis\\u003e\\n- List the commits since diverging from the main branch\\n- Summarize the nature of the changes (eg. new feature, enhancement to an existing feature, bug fix, refactoring, test, docs, etc.)\\n- Brainstorm the purpose or motivation behind these changes\\n- Assess the impact of these changes on the overall project\\n- Do not use tools to explore code, beyond what is available in the git context\\n- Check for any sensitive information that shouldn't be committed\\n- Draft a concise (1-2 bullet points) pull request summary that focuses on the \\\"why\\\" rather than the \\\"what\\\"\\n- Ensure the summary accurately reflects all changes since diverging from the main branch\\n- Ensure your language is clear, concise, and to the point\\n- Ensure the summary accurately reflects the changes and their purpose (ie. \\\"add\\\" means a wholly new feature, \\\"update\\\" means an enhancement to an existing feature, \\\"fix\\\" means a bug fix, etc.)\\n- Ensure the summary is not generic (avoid words like \\\"Update\\\" or \\\"Fix\\\" without context)\\n- Review the draft summary to ensure it accurately reflects the changes and their purpose\\n\\u003c/pr_analysis\\u003e\\n\\n6. Create PR using gh pr create with the format below. Use a HEREDOC to pass the body to ensure correct formatting.\\n\\u003cexample\\u003e\\ngh pr create --title \\\"the pr title\\\" --body \\\"$(cat \\u003c\\u003c'EOF'\\n## Summary\\n\\u003c1-3 bullet points\\u003e\\n\\n## Test plan\\n[Checklist of TODOs for testing the pull request...]\\n\\n💘 Generated with Crush\\nEOF\\n)\\\"\\n\\u003c/example\\u003e\\n\\nImportant:\\n- Return an empty response - the user will see the gh output directly\\n- Never update git config\",\"parameters\":{\"properties\":{\"command\":{\"description\":\"The command to execute\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in milliseconds (max 600000)\",\"type\":\"number\"}},\"required\":[\"command\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"download\",\"description\":\"Downloads binary data from a URL and saves it to a local file.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download files, images, or other binary data from URLs\\n- Helpful for downloading assets, documents, or any file type\\n- Useful for saving remote content locally for processing or storage\\n\\nHOW TO USE:\\n- Provide the URL to download from\\n- Specify the local file path where the content should be saved\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Downloads any file type (binary or text)\\n- Automatically creates parent directories if they don't exist\\n- Handles large files efficiently with streaming\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum file size is 100MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n- Will overwrite existing files without warning\\n\\nTIPS:\\n- Use absolute paths or paths relative to the working directory\\n- Set appropriate timeouts for large files or slow connections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The local file path where the downloaded content should be saved\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 600)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to download from\",\"type\":\"string\"}},\"required\":[\"url\",\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"edit\",\"description\":\"Edits files by replacing text, creating new files, or deleting content. For moving or renaming files, use the Bash tool with the 'mv' command instead. For larger file edits, use the FileWrite tool to overwrite files.\\n\\nBefore using this tool:\\n\\n1. Use the FileRead tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct (only applicable when creating new files):\\n   - Use the LS tool to verify the parent directory exists and is the correct location\\n\\nTo make a file edit, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. old_string: The text to replace (must be unique within the file, and must match the file contents exactly, including all whitespace and indentation)\\n3. new_string: The edited text to replace the old_string\\n4. replace_all: Replace all occurrences of old_string (default false)\\n\\nSpecial cases:\\n- To create a new file: provide file_path and new_string, leave old_string empty\\n- To delete content: provide file_path and old_string, leave new_string empty\\n\\nThe tool will replace ONE occurrence of old_string with new_string in the specified file by default. Set replace_all to true to replace all occurrences.\\n\\nCRITICAL REQUIREMENTS FOR USING THIS TOOL:\\n\\n1. UNIQUENESS: When replace_all is false (default), the old_string MUST uniquely identify the specific instance you want to change. This means:\\n   - Include AT LEAST 3-5 lines of context BEFORE the change point\\n   - Include AT LEAST 3-5 lines of context AFTER the change point\\n   - Include all whitespace, indentation, and surrounding code exactly as it appears in the file\\n\\n2. SINGLE INSTANCE: When replace_all is false, this tool can only change ONE instance at a time. If you need to change multiple instances:\\n   - Set replace_all to true to replace all occurrences at once\\n   - Or make separate calls to this tool for each instance\\n   - Each call must uniquely identify its specific instance using extensive context\\n\\n3. VERIFICATION: Before using this tool:\\n   - Check how many instances of the target text exist in the file\\n   - If multiple instances exist and replace_all is false, gather enough context to uniquely identify each one\\n   - Plan separate tool calls for each instance or use replace_all\\n\\nWARNING: If you do not follow these requirements:\\n   - The tool will fail if old_string matches multiple locations and replace_all is false\\n   - The tool will fail if old_string doesn't match exactly (including whitespace)\\n   - You may change the wrong instance if you don't include enough context\\n\\nWhen making edits:\\n   - Ensure the edit results in idiomatic, correct code\\n   - Do not leave the code in a broken state\\n   - Always use absolute file paths (starting with /)\\n\\nWINDOWS NOTES:\\n- File paths should use forward slashes (/) for cross-platform compatibility\\n- On Windows, absolute paths start with drive letters (C:/) but forward slashes work throughout\\n- File permissions are handled automatically by the Go runtime\\n\\nRemember: when making multiple file edits in a row to the same file, you should prefer to send all edits in a single message with multiple calls to this tool, rather than multiple messages with a single call each.\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"},\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"description\":\"Replace all occurrences of old_string (default false)\",\"type\":\"boolean\"}},\"required\":[\"file_path\",\"old_string\",\"new_string\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"multiedit\",\"description\":\"This is a tool for making multiple edits to a single file in one operation. It is built on top of the Edit tool and allows you to perform multiple find-and-replace operations efficiently. Prefer this tool over the Edit tool when you need to make multiple edits to the same file.\\n\\nBefore using this tool:\\n\\n1. Use the Read tool to understand the file's contents and context\\n\\n2. Verify the directory path is correct\\n\\nTo make multiple file edits, provide the following:\\n1. file_path: The absolute path to the file to modify (must be absolute, not relative)\\n2. edits: An array of edit operations to perform, where each edit contains:\\n   - old_string: The text to replace (must match the file contents exactly, including all whitespace and indentation)\\n   - new_string: The edited text to replace the old_string\\n   - replace_all: Replace all occurrences of old_string. This parameter is optional and defaults to false.\\n\\nIMPORTANT:\\n- All edits are applied in sequence, in the order they are provided\\n- Each edit operates on the result of the previous edit\\n- All edits must be valid for the operation to succeed - if any edit fails, none will be applied\\n- This tool is ideal when you need to make several changes to different parts of the same file\\n\\nCRITICAL REQUIREMENTS:\\n1. All edits follow the same requirements as the single Edit tool\\n2. The edits are atomic - either all succeed or none are applied\\n3. Plan your edits carefully to avoid conflicts between sequential operations\\n\\nWARNING:\\n- The tool will fail if edits.old_string doesn't match the file contents exactly (including whitespace)\\n- The tool will fail if edits.old_string and edits.new_string are the same\\n- Since edits are applied in sequence, ensure that earlier edits don't affect the text that later edits are trying to find\\n\\nWhen making edits:\\n- Ensure all edits result in idiomatic, correct code\\n- Do not leave the code in a broken state\\n- Always use absolute file paths (starting with /)\\n- Only use emojis if the user explicitly requests it. Avoid adding emojis to files unless asked.\\n- Use replace_all for replacing and renaming strings across the file. This parameter is useful if you want to rename a variable for instance.\\n\\nIf you want to create a new file, use:\\n- A new file path, including dir name if needed\\n- First edit: empty old_string and the new file's contents as new_string\\n- Subsequent edits: normal edit operations on the created content\",\"parameters\":{\"properties\":{\"edits\":{\"description\":\"Array of edit operations to perform sequentially on the file\",\"items\":{\"additionalProperties\":false,\"properties\":{\"new_string\":{\"description\":\"The text to replace it with\",\"type\":\"string\"},\"old_string\":{\"description\":\"The text to replace\",\"type\":\"string\"},\"replace_all\":{\"default\":false,\"description\":\"Replace all occurrences of old_string (default false).\",\"type\":\"boolean\"}},\"required\":[\"old_string\",\"new_string\"],\"type\":\"object\"},\"minItems\":1,\"type\":\"array\"},\"file_path\":{\"description\":\"The absolute path to the file to modify\",\"type\":\"string\"}},\"required\":[\"file_path\",\"edits\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"fetch\",\"description\":\"Fetches content from a URL and returns it in the specified format.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to download content from a URL\\n- Helpful for retrieving documentation, API responses, or web content\\n- Useful for getting external information to assist with tasks\\n\\nHOW TO USE:\\n- Provide the URL to fetch content from\\n- Specify the desired output format (text, markdown, or html)\\n- Optionally set a timeout for the request\\n\\nFEATURES:\\n- Supports three output formats: text, markdown, and html\\n- Automatically handles HTTP redirects\\n- Sets reasonable timeouts to prevent hanging\\n- Validates input parameters before making requests\\n\\nLIMITATIONS:\\n- Maximum response size is 5MB\\n- Only supports HTTP and HTTPS protocols\\n- Cannot handle authentication or cookies\\n- Some websites may block automated requests\\n\\nTIPS:\\n- Use text format for plain text content or simple API responses\\n- Use markdown format for content that should be rendered with formatting\\n- Use html format when you need the raw HTML structure\\n- Set appropriate timeouts for potentially slow websites\",\"parameters\":{\"properties\":{\"format\":{\"description\":\"The format to return the content in (text, markdown, or html)\",\"enum\":[\"text\",\"markdown\",\"html\"],\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"},\"url\":{\"description\":\"The URL to fetch content from\",\"type\":\"string\"}},\"required\":[\"url\",\"format\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"glob\",\"description\":\"Fast file pattern matching tool that finds files by name and pattern, returning matching paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files by name patterns or extensions\\n- Great for finding specific file types across a directory structure\\n- Useful for discovering files that match certain naming conventions\\n\\nHOW TO USE:\\n- Provide a glob pattern to match against file paths\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Results are sorted with most recently modified files first\\n\\nGLOB PATTERN SYNTAX:\\n- '*' matches any sequence of non-separator characters\\n- '**' matches any sequence of characters, including separators\\n- '?' matches any single non-separator character\\n- '[...]' matches any character in the brackets\\n- '[!...]' matches any character not in the brackets\\n\\nCOMMON PATTERN EXAMPLES:\\n- '*.js' - Find all JavaScript files in the current directory\\n- '**/*.js' - Find all JavaScript files in any subdirectory\\n- 'src/**/*.{ts,tsx}' - Find all TypeScript files in the src directory\\n- '*.{html,css,js}' - Find all HTML, CSS, and JS files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Does not search file contents (use Grep tool for that)\\n- Hidden files (starting with '.') are skipped\\n\\nWINDOWS NOTES:\\n- Path separators are handled automatically (both / and \\\\ work)\\n- Uses ripgrep (rg) command if available, otherwise falls back to built-in Go implementation\\n\\nTIPS:\\n- Patterns should use forward slashes (/) for cross-platform compatibility\\n- For the most useful results, combine with the Grep tool: first find files with Glob, then search their contents with Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\",\"parameters\":{\"properties\":{\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The glob pattern to match files against\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"grep\",\"description\":\"Fast content search tool that finds files containing specific text or patterns, returning matching file paths sorted by modification time (newest first).\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find files containing specific text or patterns\\n- Great for searching code bases for function names, variable declarations, or error messages\\n- Useful for finding all files that use a particular API or pattern\\n\\nHOW TO USE:\\n- Provide a regex pattern to search for within file contents\\n- Set literal_text=true if you want to search for the exact text with special characters (recommended for non-regex users)\\n- Optionally specify a starting directory (defaults to current working directory)\\n- Optionally provide an include pattern to filter which files to search\\n- Results are sorted with most recently modified files first\\n\\nREGEX PATTERN SYNTAX (when literal_text=false):\\n- Supports standard regular expression syntax\\n- 'function' searches for the literal text \\\"function\\\"\\n- 'log\\\\..*Error' finds text starting with \\\"log.\\\" and ending with \\\"Error\\\"\\n- 'import\\\\s+.*\\\\s+from' finds import statements in JavaScript/TypeScript\\n\\nCOMMON INCLUDE PATTERN EXAMPLES:\\n- '*.js' - Only search JavaScript files\\n- '*.{ts,tsx}' - Only search TypeScript files\\n- '*.go' - Only search Go files\\n\\nLIMITATIONS:\\n- Results are limited to 100 files (newest first)\\n- Performance depends on the number of files being searched\\n- Very large binary files may be skipped\\n- Hidden files (starting with '.') are skipped\\n\\nIGNORE FILE SUPPORT:\\n- Respects .gitignore patterns to skip ignored files and directories\\n- Respects .crushignore patterns for additional ignore rules\\n- Both ignore files are automatically detected in the search root directory\\n\\nCROSS-PLATFORM NOTES:\\n- Uses ripgrep (rg) command if available for better performance\\n- Falls back to built-in Go implementation if ripgrep is not available\\n- File paths are normalized automatically for cross-platform compatibility\\n\\nTIPS:\\n- For faster, more targeted searches, first use Glob to find relevant files, then use Grep\\n- When doing iterative exploration that may require multiple rounds of searching, consider using the Agent tool instead\\n- Always check if results are truncated and refine your search pattern if needed\\n- Use literal_text=true when searching for exact text containing special characters like dots, parentheses, etc.\",\"parameters\":{\"properties\":{\"include\":{\"description\":\"File pattern to include in the search (e.g. \\\"*.js\\\", \\\"*.{ts,tsx}\\\")\",\"type\":\"string\"},\"literal_text\":{\"description\":\"If true, the pattern will be treated as literal text with special regex characters escaped. Default is false.\",\"type\":\"boolean\"},\"path\":{\"description\":\"The directory to search in. Defaults to the current working directory.\",\"type\":\"string\"},\"pattern\":{\"description\":\"The regex pattern to search for in file contents\",\"type\":\"string\"}},\"required\":[\"pattern\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"ls\",\"description\":\"Directory listing tool that shows files and subdirectories in a tree structure, helping you explore and understand the project organization.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to explore the structure of a directory\\n- Helpful for understanding the organization of a project\\n- Good first step when getting familiar with a new codebase\\n\\nHOW TO USE:\\n- Provide a path to list (defaults to current working directory)\\n- Optionally specify glob patterns to ignore\\n- Results are displayed in a tree structure\\n\\nFEATURES:\\n- Displays a hierarchical view of files and directories\\n- Automatically skips hidden files/directories (starting with '.')\\n- Skips common system directories like __pycache__\\n- Can filter out files matching specific patterns\\n\\nLIMITATIONS:\\n- Results are limited to 1000 files\\n- Very large directories will be truncated\\n- Does not show file sizes or permissions\\n- Cannot recursively list all directories in a large project\\n\\nWINDOWS NOTES:\\n- Hidden file detection uses Unix convention (files starting with '.')\\n- Windows-specific hidden files (with hidden attribute) are not automatically skipped\\n- Common Windows directories like System32, Program Files are not in default ignore list\\n- Path separators are handled automatically (both / and \\\\ work)\\n\\nTIPS:\\n- Use Glob tool for finding files by name patterns instead of browsing\\n- Use Grep tool for searching file contents\\n- Combine with other tools for more effective exploration\",\"parameters\":{\"properties\":{\"ignore\":{\"description\":\"List of glob patterns to ignore\",\"items\":{\"type\":\"string\"},\"type\":\"array\"},\"path\":{\"description\":\"The path to the directory to list (defaults to current working directory)\",\"type\":\"string\"}},\"required\":[\"path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"sourcegraph\",\"description\":\"Search code across public repositories using Sourcegraph's GraphQL API.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to find code examples or implementations across public repositories\\n- Helpful for researching how others have solved similar problems\\n- Useful for discovering patterns and best practices in open source code\\n\\nHOW TO USE:\\n- Provide a search query using Sourcegraph's query syntax\\n- Optionally specify the number of results to return (default: 10)\\n- Optionally set a timeout for the request\\n\\nQUERY SYNTAX:\\n- Basic search: \\\"fmt.Println\\\" searches for exact matches\\n- File filters: \\\"file:.go fmt.Println\\\" limits to Go files\\n- Repository filters: \\\"repo:^github\\\\.com/golang/go$ fmt.Println\\\" limits to specific repos\\n- Language filters: \\\"lang:go fmt.Println\\\" limits to Go code\\n- Boolean operators: \\\"fmt.Println AND log.Fatal\\\" for combined terms\\n- Regular expressions: \\\"fmt\\\\.(Print|Printf|Println)\\\" for pattern matching\\n- Quoted strings: \\\"\\\\\\\"exact phrase\\\\\\\"\\\" for exact phrase matching\\n- Exclude filters: \\\"-file:test\\\" or \\\"-repo:forks\\\" to exclude matches\\n\\nADVANCED FILTERS:\\n- Repository filters:\\n  * \\\"repo:name\\\" - Match repositories with name containing \\\"name\\\"\\n  * \\\"repo:^github\\\\.com/org/repo$\\\" - Exact repository match\\n  * \\\"repo:org/repo@branch\\\" - Search specific branch\\n  * \\\"repo:org/repo rev:branch\\\" - Alternative branch syntax\\n  * \\\"-repo:name\\\" - Exclude repositories\\n  * \\\"fork:yes\\\" or \\\"fork:only\\\" - Include or only show forks\\n  * \\\"archived:yes\\\" or \\\"archived:only\\\" - Include or only show archived repos\\n  * \\\"visibility:public\\\" or \\\"visibility:private\\\" - Filter by visibility\\n\\n- File filters:\\n  * \\\"file:\\\\.js$\\\" - Files with .js extension\\n  * \\\"file:internal/\\\" - Files in internal directory\\n  * \\\"-file:test\\\" - Exclude test files\\n  * \\\"file:has.content(Copyright)\\\" - Files containing \\\"Copyright\\\"\\n  * \\\"file:has.contributor([email protected])\\\" - Files with specific contributor\\n\\n- Content filters:\\n  * \\\"content:\\\\\\\"exact string\\\\\\\"\\\" - Search for exact string\\n  * \\\"-content:\\\\\\\"unwanted\\\\\\\"\\\" - Exclude files with unwanted content\\n  * \\\"case:yes\\\" - Case-sensitive search\\n\\n- Type filters:\\n  * \\\"type:symbol\\\" - Search for symbols (functions, classes, etc.)\\n  * \\\"type:file\\\" - Search file content only\\n  * \\\"type:path\\\" - Search filenames only\\n  * \\\"type:diff\\\" - Search code changes\\n  * \\\"type:commit\\\" - Search commit messages\\n\\n- Commit/diff search:\\n  * \\\"after:\\\\\\\"1 month ago\\\\\\\"\\\" - Commits after date\\n  * \\\"before:\\\\\\\"2023-01-01\\\\\\\"\\\" - Commits before date\\n  * \\\"author:name\\\" - Commits by author\\n  * \\\"message:\\\\\\\"fix bug\\\\\\\"\\\" - Commits with message\\n\\n- Result selection:\\n  * \\\"select:repo\\\" - Show only repository names\\n  * \\\"select:file\\\" - Show only file paths\\n  * \\\"select:content\\\" - Show only matching content\\n  * \\\"select:symbol\\\" - Show only matching symbols\\n\\n- Result control:\\n  * \\\"count:100\\\" - Return up to 100 results\\n  * \\\"count:all\\\" - Return all results\\n  * \\\"timeout:30s\\\" - Set search timeout\\n\\nEXAMPLES:\\n- \\\"file:.go context.WithTimeout\\\" - Find Go code using context.WithTimeout\\n- \\\"lang:typescript useState type:symbol\\\" - Find TypeScript React useState hooks\\n- \\\"repo:^github\\\\.com/kubernetes/kubernetes$ pod list type:file\\\" - Find Kubernetes files related to pod listing\\n- \\\"repo:sourcegraph/sourcegraph$ after:\\\\\\\"3 months ago\\\\\\\" type:diff database\\\" - Recent changes to database code\\n- \\\"file:Dockerfile (alpine OR ubuntu) -content:alpine:latest\\\" - Dockerfiles with specific base images\\n- \\\"repo:has.path(\\\\.py) file:requirements.txt tensorflow\\\" - Python projects using TensorFlow\\n\\nBOOLEAN OPERATORS:\\n- \\\"term1 AND term2\\\" - Results containing both terms\\n- \\\"term1 OR term2\\\" - Results containing either term\\n- \\\"term1 NOT term2\\\" - Results with term1 but not term2\\n- \\\"term1 and (term2 or term3)\\\" - Grouping with parentheses\\n\\nLIMITATIONS:\\n- Only searches public repositories\\n- Rate limits may apply\\n- Complex queries may take longer to execute\\n- Maximum of 20 results per query\\n\\nTIPS:\\n- Use specific file extensions to narrow results\\n- Add repo: filters for more targeted searches\\n- Use type:symbol to find function/method definitions\\n- Use type:file to find relevant files\",\"parameters\":{\"properties\":{\"context_window\":{\"description\":\"The context around the match to return (default: 10 lines)\",\"type\":\"number\"},\"count\":{\"description\":\"Optional number of results to return (default: 10, max: 20)\",\"type\":\"number\"},\"query\":{\"description\":\"The Sourcegraph search query\",\"type\":\"string\"},\"timeout\":{\"description\":\"Optional timeout in seconds (max 120)\",\"type\":\"number\"}},\"required\":[\"query\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"view\",\"description\":\"File viewing tool that reads and displays the contents of files with line numbers, allowing you to examine code, logs, or text data.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to read the contents of a specific file\\n- Helpful for examining source code, configuration files, or log files\\n- Perfect for looking at text-based file formats\\n\\nHOW TO USE:\\n- Provide the path to the file you want to view\\n- Optionally specify an offset to start reading from a specific line\\n- Optionally specify a limit to control how many lines are read\\n- Do not use this for directories use the ls tool instead\\n\\nFEATURES:\\n- Displays file contents with line numbers for easy reference\\n- Can read from any position in a file using the offset parameter\\n- Handles large files by limiting the number of lines read\\n- Automatically truncates very long lines for better display\\n- Suggests similar file names when the requested file isn't found\\n\\nLIMITATIONS:\\n- Maximum file size is 250KB\\n- Default reading limit is 2000 lines\\n- Lines longer than 2000 characters are truncated\\n- Cannot display binary files or images\\n- Images can be identified but not displayed\\n\\nWINDOWS NOTES:\\n- Handles both Windows (CRLF) and Unix (LF) line endings automatically\\n- File paths work with both forward slashes (/) and backslashes (\\\\)\\n- Text encoding is detected automatically for most common formats\\n\\nTIPS:\\n- Use with Glob tool to first find files you want to view\\n- For code exploration, first use Grep to find relevant files, then View to examine them\\n- When viewing large files, use the offset parameter to read specific sections\",\"parameters\":{\"properties\":{\"file_path\":{\"description\":\"The path to the file to read\",\"type\":\"string\"},\"limit\":{\"description\":\"The number of lines to read (defaults to 2000)\",\"type\":\"integer\"},\"offset\":{\"description\":\"The line number to start reading from (0-based)\",\"type\":\"integer\"}},\"required\":[\"file_path\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"write\",\"description\":\"File writing tool that creates or updates files in the filesystem, allowing you to save or modify text content.\\n\\nWHEN TO USE THIS TOOL:\\n- Use when you need to create a new file\\n- Helpful for updating existing files with modified content\\n- Perfect for saving generated code, configurations, or text data\\n\\nHOW TO USE:\\n- Provide the path to the file you want to write\\n- Include the content to be written to the file\\n- The tool will create any necessary parent directories\\n\\nFEATURES:\\n- Can create new files or overwrite existing ones\\n- Creates parent directories automatically if they don't exist\\n- Checks if the file has been modified since last read for safety\\n- Avoids unnecessary writes when content hasn't changed\\n\\nLIMITATIONS:\\n- You should read a file before writing to it to avoid conflicts\\n- Cannot append to files (rewrites the entire file)\\n\\nWINDOWS NOTES:\\n- File permissions (0o755, 0o644) are Unix-style but work on Windows with appropriate translations\\n- Use forward slashes (/) in paths for cross-platform compatibility\\n- Windows file attributes and permissions are handled automatically by the Go runtime\\n\\nTIPS:\\n- Use the View tool first to examine existing files before modifying them\\n- Use the LS tool to verify the correct location when creating new files\\n- Combine with Glob and Grep tools to find and modify multiple files\\n- Always include descriptive comments when making changes to existing code\",\"parameters\":{\"properties\":{\"content\":{\"description\":\"The content to write to the file\",\"type\":\"string\"},\"file_path\":{\"description\":\"The path to the file to write\",\"type\":\"string\"}},\"required\":[\"file_path\",\"content\"],\"type\":\"object\"}},\"type\":\"function\"},{\"function\":{\"name\":\"agent\",\"description\":\"Launch a new agent that has access to the following tools: GlobTool, GrepTool, LS, View. When you are searching for a keyword or file and are not confident that you will find the right match on the first try, use the Agent tool to perform the search for you. For example:\\n\\n- If you are searching for a keyword like \\\"config\\\" or \\\"logger\\\", or for questions like \\\"which file does X?\\\", the Agent tool is strongly recommended\\n- If you want to read a specific file path, use the View or GlobTool tool instead of the Agent tool, to find the match more quickly\\n- If you are searching for a specific class definition like \\\"class Foo\\\", use the GlobTool tool instead, to find the match more quickly\\n\\nUsage notes:\\n1. Launch multiple agents concurrently whenever possible, to maximize performance; to do that, use a single message with multiple tool uses\\n2. When the agent is done, it will return a single message back to you. The result returned by the agent is not visible to the user. To show the user the result, you should send a text message back to the user with a concise summary of the result.\\n3. Each agent invocation is stateless. You will not be able to send additional messages to the agent, nor will the agent be able to communicate with you outside of its final report. Therefore, your prompt should contain a highly detailed task description for the agent to perform autonomously and you should specify exactly what information the agent should return back to you in its final and only message to you.\\n4. The agent's outputs should generally be trusted\\n5. IMPORTANT: The agent can not use Bash, Replace, Edit, so can not modify files. If you want to use these tools, use them directly instead of going through the agent.\",\"parameters\":{\"properties\":{\"prompt\":{\"description\":\"The task for the agent to perform\",\"type\":\"string\"}},\"required\":[\"prompt\"],\"type\":\"object\"}},\"type\":\"function\"}],\"stream\":true}"}
{"time":"2025-08-07T23:38:18.655961-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:38:12 GMT"],"X-Powered-By":["Express"]},"body":"data: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"role\":\"assistant\",\"content\":\"The\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" repo\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" is\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" a\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" personal\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" mac\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"OS\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" setup\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" tool\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" called\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" **\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"env\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"**\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" It\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" installs\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" packages\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\",\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" config\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"ures\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" tools\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\",\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" and\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" creates\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" an\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" id\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"empot\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"ent\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" development\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" environment\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{},\"logprobs\":null,\"finish_reason\":\"stop\"}]}\n\ndata: {\"id\":\"chatcmpl-vtcrv5oyulcqqoxlxzge5g\",\"object\":\"chat.completion.chunk\",\"created\":1754624292,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[],\"usage\":{\"prompt_tokens\":11118,\"completion_tokens\":35,\"total_tokens\":11153}}\n\ndata: [DONE]\n\n","content_length":-1,"duration_ms":1,"error":null}
{"time":"2025-08-07T23:38:18.661484-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).processGeneration","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":420},"msg":"Result","message":"end_turn","toolResults":null}
{"time":"2025-08-07T23:38:18.66151-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Run.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":349},"msg":"Request completed","sessionID":"f925d435-9d63-4743-8515-2964a2de9e4a"}
{"time":"2025-08-07T23:38:27.471042-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":46},"msg":"HTTP Request","method":"POST","url":{"Scheme":"http","Opaque":"","User":null,"Host":"localhost:1234","Path":"/v1/chat/completions","RawPath":"","OmitHost":false,"ForceQuery":false,"RawQuery":"","Fragment":"","RawFragment":""},"body":"{\"messages\":[{\"content\":\"You are a helpful AI assistant tasked with summarizing conversations.\\n\\nWhen asked to summarize, provide a detailed but concise summary of the conversation.\\nFocus on information that would be helpful for continuing the conversation, including:\\n\\n- What was done\\n- What is currently being worked on\\n- Which files are being modified\\n- What needs to be done next\\n\\nYour summary should be comprehensive enough to provide context but concise enough to be quickly understood.\\n\",\"role\":\"system\"},{\"content\":\"hi\",\"role\":\"user\"},{\"content\":\"Hello! How can I help you today?\",\"role\":\"assistant\"},{\"content\":\"**Conversation Summary**\\n\\n- **What was done:**  \\n  - The user greeted the assistant with “hi.”  \\n  - The assistant responded with a friendly greeting and offered help.\\n\\n- **Current status:**  \\n  - No tasks or files have been started yet; the conversation is at its initial stage.\\n\\n- **Next steps (if any):**  \\n  - Await further instructions from the user to determine what assistance they need—whether it involves code, documentation, or another topic.\\n\\n**Current working directory of the persistent shell**\\n\\n/Users/roly/Developer/env\",\"role\":\"assistant\"},{\"content\":\"what is this project about?\",\"role\":\"user\"},{\"tool_calls\":[{\"id\":\"375663523\",\"function\":{\"arguments\":\"{\\\"file_path\\\":\\\"/Users/roly/Developer/env/README.md\\\",\\\"limit\\\":200}\",\"name\":\"view\"},\"type\":\"function\"}],\"role\":\"assistant\"},{\"content\":\"\\u003cfile\\u003e\\n     1|# env\\n     2|\\n     3|An idempotent, (mostly) unattended tool to configure macOS with everything I need to be productive. Essential packages are installed and configured to create my development environment.\\n     4|\\n     5|This project should be considered personal software and was developed for an audience of one.\\n     6|\\n     7|## Prerequisites\\n     8|\\n     9|- macOS\\n    10|- internet access\\n    11|- sudo\\n    12|\\n    13|## Usage\\n    14|\\n    15|`sh -c $(curl -fsSL env.roly.sh)`\\n    16|`wget -O- env.roly.sh`\\n    17|\\n    18|## Acknowledgements\\n    19|\\n    20|- Omakub, Omarchy, Crucible - spiritual kinship, inspiration\\n    21|- Homebrew - a pillar in macOS computing\\n    22|- Gum - a crucial utility that transformed the UX of this project\\n    23|\\n    24|## TODO\\n    25|\\n    26|- make README nicer and add links to Acknowledgements\\n    27|- support at least one Linux distro (likely Arch)\\n\\u003c/file\\u003e\\n\",\"tool_call_id\":\"375663523\",\"role\":\"tool\"},{\"content\":\"The repo is a personal macOS setup tool called **env**. It installs packages, configures tools, and creates an idempotent development environment.\",\"role\":\"assistant\"},{\"content\":\"Provide a detailed but concise summary of our conversation above. Focus on information that would be helpful for continuing the conversation, including what we did, what we're doing, which files we're working on, and what we're going to do next.\",\"role\":\"user\"}],\"model\":\"openai/gpt-oss-20b\",\"max_tokens\":4096,\"stream_options\":{\"include_usage\":true},\"stream\":true}"}
{"time":"2025-08-07T23:38:36.918128-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/log.(*HTTPRoundTripLogger).RoundTrip","file":"/home/runner/work/crush/crush/internal/log/http.go","line":68},"msg":"HTTP Response","status_code":200,"status":"200 OK","headers":{"Cache-Control":["no-cache"],"Connection":["keep-alive"],"Content-Type":["text/event-stream"],"Date":["Fri, 08 Aug 2025 03:38:27 GMT"],"X-Powered-By":["Express"]},"body":"data: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"role\":\"assistant\",\"reasoning_content\":\"We\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" need\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" to\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" summarize\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\":\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" user\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" asked\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" project\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" about\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\";\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" assistant\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" opened\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" README\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" So\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" summary\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\" accordingly\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"reasoning_content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"**\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"Conversation\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" Summary\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"**\\n\\n\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"|\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" Item\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" |\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" Details\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" |\\n\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"|\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"------\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"|\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"---------\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"|\\n\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"|\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" **\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"What\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" was\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" done\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"**\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" |\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" •\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" User\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" in\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"quired\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" about\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" the\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" purpose\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" of\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" the\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" project\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\".<\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"br\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\">\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"•\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" Assistant\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" read\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" and\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" displayed\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" the\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" first\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" \"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"200\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" characters\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" of\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" `\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"README\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\".md\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"`,\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" explaining\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" that\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" the\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" repo\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" is\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" a\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" personal\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" mac\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"OS\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" setup\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" tool\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" named\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" *\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"env\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"*\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" that\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" installs\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" packages\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" and\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" config\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"ures\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" a\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" development\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" environment\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" |\\n\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"|\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" **\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"Current\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" status\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"**\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" |\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" No\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" modifications\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" to\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" any\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" files\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" yet\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\";\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" we\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" are\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" only\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" reviewing\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" documentation\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" |\\n\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"|\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" **\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"Files\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" involved\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"**\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" |\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" `\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"README\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\".md\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"`\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" (\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"view\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"ed\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" for\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" context\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\").\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" |\\n\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"|\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" **\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"Next\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" steps\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"**\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" |\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" •\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" Clar\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"ify\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" what\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" the\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" user\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" wants\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" next\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\":\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" e\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\".g\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\".,\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" exploring\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" specific\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" configuration\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" scripts\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\",\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" understanding\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" installation\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" flow\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\",\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" or\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" editing\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" README\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"/\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"adding\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" features\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\".<\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"br\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\">\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"•\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" If\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" the\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" user\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" needs\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" help\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" with\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" a\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" particular\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" file\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" or\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" function\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\",\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" identify\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" and\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" open\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" that\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" file\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\".\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" |\\n\\n\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"Feel\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" free\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" to\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" let\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" me\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" know\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" how\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" you\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"’d\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" like\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" to\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\" proceed\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{\"content\":\"!\"},\"logprobs\":null,\"finish_reason\":null}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[{\"index\":0,\"delta\":{},\"logprobs\":null,\"finish_reason\":\"stop\"}]}\n\ndata: {\"id\":\"chatcmpl-ubxn0qs7ihldboqoqzn7bd\",\"object\":\"chat.completion.chunk\",\"created\":1754624307,\"model\":\"openai/gpt-oss-20b\",\"system_fingerprint\":\"openai/gpt-oss-20b\",\"choices\":[],\"usage\":{\"prompt_tokens\":705,\"completion_tokens\":209,\"total_tokens\":914}}\n\ndata: [DONE]\n\n","content_length":-1,"duration_ms":8,"error":null}
{"time":"2025-08-07T23:41:41.364776-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"permissions-notifications"}
{"time":"2025-08-07T23:41:41.364784-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"mcp"}
{"time":"2025-08-07T23:41:41.364816-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"sessions"}
{"time":"2025-08-07T23:41:41.36484-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"coderAgent"}
{"time":"2025-08-07T23:41:41.364811-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"history"}
{"time":"2025-08-07T23:41:41.364825-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"lsp"}
{"time":"2025-08-07T23:41:41.364857-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"messages"}
{"time":"2025-08-07T23:41:41.36487-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.setupSubscriber[...].func1","file":"/home/runner/work/crush/crush/internal/app/app.go","line":247},"msg":"subscription cancelled","name":"permissions"}
{"time":"2025-08-07T23:41:41.366107-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).Subscribe.func2","file":"/home/runner/work/crush/crush/internal/app/app.go","line":291},"msg":"Cancelling TUI message handler"}
{"time":"2025-08-07T23:41:41.366121-04:00","level":"DEBUG","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).Subscribe","file":"/home/runner/work/crush/crush/internal/app/app.go","line":300},"msg":"TUI message handler shutting down"}
{"time":"2025-08-07T23:43:29.086543-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:43:29.088337-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T23:43:29.088487-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:43:29.088497-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:43:29.474957-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:43:29.637781-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T23:43:29.63889-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T23:43:29.642182-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T23:43:29.642476-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T23:43:29.643674-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T23:43:29.643707-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T23:47:21.463963-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:47:21.466403-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:47:21.46642-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:47:21.466428-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T23:47:21.466433-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T23:47:21.466513-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T23:47:21.706399-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:47:22.261377-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T23:47:22.261695-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T23:47:22.266407-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T23:47:22.267078-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T23:47:22.272788-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T23:47:22.272855-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T23:47:41.056063-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":99},"msg":"Using cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:47:41.059665-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:47:41.059684-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"lmstudio"}
{"time":"2025-08-07T23:47:41.059691-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":237},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T23:47:41.059696-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/config.(*Config).configureProviders-range1","file":"/home/runner/work/crush/crush/internal/config/load.go","line":257},"msg":"Provider is missing API key, this might be OK for local providers","provider":"ollama"}
{"time":"2025-08-07T23:47:41.059959-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.loadProviders.func1","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":103},"msg":"Updating provider cache in background"}
{"time":"2025-08-07T23:47:41.164665-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/config.saveProvidersInCache","file":"/home/runner/work/crush/crush/internal/config/provider.go","line":48},"msg":"Saving cached provider data","path":"/Users/roly/.local/share/crush/providers.json"}
{"time":"2025-08-07T23:47:41.858436-04:00","level":"INFO","msg":"goose: no migrations to run. current version: 20250627000000"}
{"time":"2025-08-07T23:47:41.859265-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/app.(*App).initLSPClients","file":"/home/runner/work/crush/crush/internal/app/lsp.go","line":18},"msg":"LSP clients initialization started in background"}
{"time":"2025-08-07T23:47:41.867273-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"task"}
{"time":"2025-08-07T23:47:41.872583-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":173},"msg":"Initializing agent tools","agent":"coder"}
{"time":"2025-08-07T23:47:41.872639-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"coder"}
{"time":"2025-08-07T23:47:41.873073-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.NewAgent.func1.1","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":175},"msg":"Initialized agent tools","agent":"task"}
{"time":"2025-08-07T23:47:46.160273-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:1234/v1/chat/completions\": dial tcp 127.0.0.1:1234: connect: connection refused","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:47:46.160362-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:47:46.206098-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:1234/v1/chat/completions\": dial tcp 127.0.0.1:1234: connect: connection refused","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:47:46.206169-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":1,"max_retries":8}
{"time":"2025-08-07T23:47:49.987543-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:1234/v1/chat/completions\": dial tcp 127.0.0.1:1234: connect: connection refused","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:47:49.989309-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:47:50.023-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:1234/v1/chat/completions\": dial tcp 127.0.0.1:1234: connect: connection refused","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:47:50.023098-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":2,"max_retries":8}
{"time":"2025-08-07T23:47:56.180143-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:1234/v1/chat/completions\": dial tcp 127.0.0.1:1234: connect: connection refused","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:47:56.180722-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:47:56.199719-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:1234/v1/chat/completions\": dial tcp 127.0.0.1:1234: connect: connection refused","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:47:56.199806-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":3,"max_retries":8}
{"time":"2025-08-07T23:48:07.126187-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:1234/v1/chat/completions\": dial tcp 127.0.0.1:1234: connect: connection refused","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:48:07.127564-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:48:07.194522-04:00","level":"ERROR","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).shouldRetry","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":523},"msg":"OpenAI API error","error":"Post \"http://localhost:1234/v1/chat/completions\": dial tcp 127.0.0.1:1234: connect: connection refused","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:48:07.194696-04:00","level":"WARN","source":{"function":"github.com/charmbracelet/crush/internal/llm/provider.(*openaiClient).stream.func1","file":"/home/runner/work/crush/crush/internal/llm/provider/openai.go","line":467},"msg":"Retrying due to rate limit","attempt":4,"max_retries":8}
{"time":"2025-08-07T23:48:16.624068-04:00","level":"INFO","source":{"function":"github.com/charmbracelet/crush/internal/llm/agent.(*agent).Cancel","file":"/home/runner/work/crush/crush/internal/llm/agent/agent.go","line":241},"msg":"Request cancellation initiated","session_id":"a513ab58-fc4e-48c0-8f8d-6dfd5f1632c5"}
